<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds          #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE DataKinds                #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass           #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE DeriveGeneric            #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE DisambiguateRecordFields #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts         #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances        #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE LambdaCase               #-}</span><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns           #-}</span><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# LANGUAGE OverloadedStrings        #-}</span><span>
</span><a name="line-11"></a><span class="hs-pragma">{-# LANGUAGE RecordWildCards          #-}</span><span>
</span><a name="line-12"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables      #-}</span><span>
</span><a name="line-13"></a><span class="hs-pragma">{-# LANGUAGE TypeApplications         #-}</span><span>
</span><a name="line-14"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies             #-}</span><span>
</span><a name="line-15"></a><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><a name="line-16"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ouroboros.Consensus.Cardano.CanHardFork</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-17"></a><span>    </span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#TriggerHardFork"><span class="hs-identifier hs-type">TriggerHardFork</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#ByronPartialLedgerConfig"><span class="hs-identifier hs-type">ByronPartialLedgerConfig</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#ShelleyPartialLedgerConfig"><span class="hs-identifier hs-type">ShelleyPartialLedgerConfig</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#CardanoHardForkConstraints"><span class="hs-identifier hs-type">CardanoHardForkConstraints</span></a><span>
</span><a name="line-21"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map.Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mapMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Proxy</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Word</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">GHC.Generics</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.DSIGN.html"><span class="hs-identifier">Cardano.Crypto.DSIGN</span></a><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.DSIGN.Ed25519.html#Ed25519DSIGN"><span class="hs-identifier hs-type">Ed25519DSIGN</span></a><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.Hash.Blake2b.html"><span class="hs-identifier">Cardano.Crypto.Hash.Blake2b</span></a><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.Hash.Blake2b.html#Blake2b_224"><span class="hs-identifier hs-type">Blake2b_224</span></a><span class="hs-special">,</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.Hash.Blake2b.html#Blake2b_256"><span class="hs-identifier hs-type">Blake2b_256</span></a><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.html"><span class="hs-identifier">Cardano.Prelude</span></a><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#NoUnexpectedThunks"><span class="hs-identifier hs-type">NoUnexpectedThunks</span></a><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src/Cardano.Chain.Update.html"><span class="hs-identifier">Cardano.Chain.Update</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">CC.Update</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Block.html"><span class="hs-identifier">Ouroboros.Consensus.Block</span></a><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Ledger.Abstract.html"><span class="hs-identifier">Ouroboros.Consensus.Ledger.Abstract</span></a><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.TypeFamilyWrappers.html"><span class="hs-identifier">Ouroboros.Consensus.TypeFamilyWrappers</span></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Util.RedundantConstraints.html"><span class="hs-identifier">Ouroboros.Consensus.Util.RedundantConstraints</span></a><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.html"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator</span></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.State.Types.html"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.State.Types</span></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.InPairs.html"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.Util.InPairs</span></a><span>
</span><a name="line-43"></a><span>                     </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.InPairs.html#RequiringBoth"><span class="hs-identifier hs-type">RequiringBoth</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.InPairs.html"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.Util.InPairs</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">InPairs</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.Tails.html"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.Util.Tails</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Tails</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.html"><span class="hs-identifier">Ouroboros.Consensus.Byron.Ledger</span></a><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.Inspect.html"><span class="hs-identifier">Ouroboros.Consensus.Byron.Ledger.Inspect</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Byron.Inspect</span><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Node.html"><span class="hs-identifier">Ouroboros.Consensus.Byron.Node</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Protocol.PBFT.html"><span class="hs-identifier">Ouroboros.Consensus.Protocol.PBFT</span></a><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Protocol.PBFT.html#PBft"><span class="hs-identifier hs-type">PBft</span></a><span class="hs-special">,</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Protocol.PBFT.Crypto.html#PBftCrypto"><span class="hs-identifier hs-type">PBftCrypto</span></a><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Protocol.PBFT.State.html"><span class="hs-identifier">Ouroboros.Consensus.Protocol.PBFT.State</span></a><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Protocol.PBFT.State.html#PBftState"><span class="hs-identifier hs-type">PBftState</span></a><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Protocol.PBFT.State.html"><span class="hs-identifier">Ouroboros.Consensus.Protocol.PBFT.State</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">PBftState</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Ledger.html"><span class="hs-identifier">Ouroboros.Consensus.Shelley.Ledger</span></a><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Node.html"><span class="hs-identifier">Ouroboros.Consensus.Shelley.Node</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Protocol.html"><span class="hs-identifier">Ouroboros.Consensus.Shelley.Protocol</span></a><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Cardano.Ledger.Crypto.html"><span class="hs-identifier">Cardano.Ledger.Crypto</span></a><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Cardano.Ledger.Crypto.html#ADDRHASH"><span class="hs-identifier hs-type">ADDRHASH</span></a><span class="hs-special">,</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Cardano.Ledger.Crypto.html#DSIGN"><span class="hs-identifier hs-type">DSIGN</span></a><span class="hs-special">,</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Cardano.Ledger.Crypto.html#HASH"><span class="hs-identifier hs-type">HASH</span></a><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Cardano.Ledger.Era.html"><span class="hs-identifier">Cardano.Ledger.Era</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Era</span><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Shelley.Spec.Ledger.API.html"><span class="hs-identifier">Shelley.Spec.Ledger.API</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">SL</span><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Shelley.Spec.Ledger.BaseTypes.html"><span class="hs-identifier">Shelley.Spec.Ledger.BaseTypes</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">SL</span><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Shelley.Spec.Ledger.ByronTranslation.html"><span class="hs-identifier">Shelley.Spec.Ledger.ByronTranslation</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">SL</span><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Shelley.Spec.Ledger.STS.Prtcl.html"><span class="hs-identifier">Shelley.Spec.Ledger.STS.Prtcl</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">SL</span><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Shelley.Spec.Ledger.STS.Tickn.html"><span class="hs-identifier">Shelley.Spec.Ledger.STS.Tickn</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">SL</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span>           </span><a href="Ouroboros.Consensus.Cardano.Block.html"><span class="hs-identifier">Ouroboros.Consensus.Cardano.Block</span></a><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-comment">{-------------------------------------------------------------------------------
  Figure out the transition point for Byron

  The Byron ledger defines the update 'State' in
  &quot;Cardano.Chain.Update.Validation.Interface&quot;. The critical piece of state we
  need is

  &gt; candidateProtocolUpdates :: ![CandidateProtocolUpdate]

  which are the update proposals that have been voted on, accepted, and
  endorsed, and now need to become stable. In `tryBumpVersion`
  (&quot;Cardano.Chain.Update.Validation.Interface.ProtocolVersionBump&quot;) we
  find the candidates that are at least 'kUpdateStabilityParam' (@== 4k@) deep,
  and then construct

  &gt; State
  &gt; { nextProtocolVersion    = cpuProtocolVersion
  &gt; , nextProtocolParameters = cpuProtocolParameters
  &gt; }

  (with 'State' from &quot;Cardano.Chain.Update.Validation.Interface.ProtocolVersionBump&quot;)
  where 'cpuProtocolVersion'/'cpuProtocolParameters' are the version and
  parameters from the update. This then ends up in the following callstack

  &gt; applyChainTick
  &gt; |
  &gt; \-- epochTransition
  &gt;     |
  &gt;     \-- registerEpoch
  &gt;         |
  &gt;         \-- tryBumpVersion

  Now, if this is changing the major version of the protocol, then this actually
  indicates the transition to Shelley, and the Byron 'applyChainTick' won't
  actually happen. Instead, in 'singleEraTransition' we will report the
  'EpochNo' of the transition as soon as it's @2k@ (not @4k@!) deep: in other
  words, as soon as it is stable; at this point, the HFC will do the rest.

  A slightly subtle point is that the Byron ledger does not record any
  information about /past/ updates to the protocol parameters, and so if we
  /were/ to ask the Byron ledger /after/ the update when the transition is
  going to take place (did take place), it will say 'Nothing': transition not
  yet known. In practice this won't matter, as it will have been translated to
  a Shelley ledger at that point.
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-identifier">byronTransition</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.PartialConfig.html#PartialLedgerConfig"><span class="hs-identifier hs-type">PartialLedgerConfig</span></a><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a><span>
</span><a name="line-116"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word16</span><span>   </span><span class="hs-comment">-- ^ Shelley major protocol version</span><span>
</span><a name="line-117"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Ledger.Basics.html#LedgerState"><span class="hs-identifier hs-type">LedgerState</span></a><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a><span>
</span><a name="line-118"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-type">EpochNo</span></a><span>
</span><a name="line-119"></a><a name="byronTransition"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#byronTransition"><span class="hs-identifier">byronTransition</span></a></a><span> </span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#ByronPartialLedgerConfig"><span class="hs-identifier hs-var">ByronPartialLedgerConfig</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><a name="local-6989586621679130416"><a href="#local-6989586621679130416"><span class="hs-identifier">shelleyMajorVersion</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-120"></a><span>      </span><a href="#local-6989586621679130418"><span class="hs-identifier hs-var">latest</span></a><span>
</span><a name="line-121"></a><span>    </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">mapMaybe</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.Inspect.html#isStableCandidate"><span class="hs-identifier hs-var">Byron.Inspect.isStableCandidate</span></a><span>
</span><a name="line-122"></a><span>    </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><a href="#local-6989586621679130417"><span class="hs-identifier hs-var">bumpsMajorProtocolVersion</span></a><span>
</span><a name="line-123"></a><span>    </span><span class="hs-operator hs-var">.</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.Inspect.html#protocolUpdates"><span class="hs-identifier hs-var">Byron.Inspect.protocolUpdates</span></a><span> </span><a href="#local-6989586621679130414"><span class="hs-identifier hs-var">byronLedgerConfig</span></a><span>
</span><a name="line-124"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-125"></a><span>    </span><span class="hs-identifier">bumpsMajorProtocolVersion</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.Inspect.html#ProtocolUpdate"><span class="hs-identifier hs-type">Byron.Inspect.ProtocolUpdate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-126"></a><span>    </span><a name="local-6989586621679130417"><a href="#local-6989586621679130417"><span class="hs-identifier">bumpsMajorProtocolVersion</span></a></a><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.Inspect.html#ProtocolUpdate"><span class="hs-identifier hs-var">Byron.Inspect.ProtocolUpdate</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-127"></a><span>           </span><a href="#local-6989586621679130416"><span class="hs-identifier hs-var">shelleyMajorVersion</span></a><span>
</span><a name="line-128"></a><span>        </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier">CC.Update.pvMajor</span><span> </span><a href="#local-6989586621679130424"><span class="hs-identifier hs-var">protocolUpdateVersion</span></a><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span>    </span><span class="hs-comment">-- 'tryBumpVersion' assumes head of the list of stable proposals is the</span><span>
</span><a name="line-131"></a><span>    </span><span class="hs-comment">-- newest, so we do too</span><span>
</span><a name="line-132"></a><span>    </span><span class="hs-identifier">latest</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130419"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679130419"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-133"></a><span>    </span><a name="local-6989586621679130418"><a href="#local-6989586621679130418"><span class="hs-identifier">latest</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679134269"><a href="#local-6989586621679134269"><span class="hs-identifier">newest</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679134269"><span class="hs-identifier hs-var">newest</span></a><span>
</span><a name="line-134"></a><span>    </span><span class="hs-identifier">latest</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">{-------------------------------------------------------------------------------
  SingleEraBlock Byron
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#SingleEraBlock"><span class="hs-identifier hs-type">SingleEraBlock</span></a><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-141"></a><span>  </span><a name="local-8214565720323806228"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#singleEraTransition"><span class="hs-identifier">singleEraTransition</span></a></a><span> </span><a name="local-6989586621679130401"><a href="#local-6989586621679130401"><span class="hs-identifier">pcfg</span></a></a><span> </span><a name="local-6989586621679130402"><a href="#local-6989586621679130402"><span class="hs-identifier">_eraParams</span></a></a><span> </span><a name="local-6989586621679130403"><a href="#local-6989586621679130403"><span class="hs-identifier">_eraStart</span></a></a><span> </span><a name="local-6989586621679130404"><a href="#local-6989586621679130404"><span class="hs-identifier">ledgerState</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-142"></a><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">triggerHardFork</span><span> </span><a href="#local-6989586621679130401"><span class="hs-identifier hs-var">pcfg</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-143"></a><span>        </span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#TriggerHardForkNever"><span class="hs-identifier hs-var">TriggerHardForkNever</span></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-144"></a><span>        </span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#TriggerHardForkAtEpoch"><span class="hs-identifier hs-var">TriggerHardForkAtEpoch</span></a><span>   </span><a name="local-6989586621679130405"><a href="#local-6989586621679130405"><span class="hs-identifier">epoch</span></a></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679130405"><span class="hs-identifier hs-var">epoch</span></a><span>
</span><a name="line-145"></a><span>        </span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#TriggerHardForkAtVersion"><span class="hs-identifier hs-var">TriggerHardForkAtVersion</span></a><span> </span><a name="local-6989586621679130406"><a href="#local-6989586621679130406"><span class="hs-identifier">shelleyMajorVersion</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-146"></a><span>            </span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#byronTransition"><span class="hs-identifier hs-var">byronTransition</span></a><span>
</span><a name="line-147"></a><span>              </span><a href="#local-6989586621679130401"><span class="hs-identifier hs-var">pcfg</span></a><span>
</span><a name="line-148"></a><span>              </span><a href="#local-6989586621679130406"><span class="hs-identifier hs-var">shelleyMajorVersion</span></a><span>
</span><a name="line-149"></a><span>              </span><a href="#local-6989586621679130404"><span class="hs-identifier hs-var">ledgerState</span></a><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span>  </span><a name="local-8214565720323806227"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#singleEraInfo"><span class="hs-identifier">singleEraInfo</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Info.html#SingleEraInfo"><span class="hs-identifier hs-var">SingleEraInfo</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-152"></a><span>      </span><span class="hs-identifier">singleEraName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Byron&quot;</span><span>
</span><a name="line-153"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Protocol.PBFT.Crypto.html#PBftCrypto"><span class="hs-identifier hs-type">PBftCrypto</span></a><span> </span><a href="#local-6989586621679130400"><span class="hs-identifier hs-type">bc</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.PartialConfig.html#HasPartialConsensusConfig"><span class="hs-identifier hs-type">HasPartialConsensusConfig</span></a><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Protocol.PBFT.html#PBft"><span class="hs-identifier hs-type">PBft</span></a><span> </span><a href="#local-6989586621679130400"><span class="hs-identifier hs-type">bc</span></a><span class="hs-special">)</span><span>
</span><a name="line-156"></a><span>  </span><span class="hs-comment">-- Use defaults</span><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-comment">-- | The trigger condition that will cause the hard fork transition.</span><span>
</span><a name="line-159"></a><span class="hs-keyword">data</span><span> </span><a name="TriggerHardFork"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#TriggerHardFork"><span class="hs-identifier">TriggerHardFork</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-160"></a><span>    </span><span class="hs-comment">-- | Trigger the transition when the on-chain protocol major version (from</span><span>
</span><a name="line-161"></a><span>    </span><span class="hs-comment">-- the ledger state) reaches this number.</span><span>
</span><a name="line-162"></a><span>    </span><a name="TriggerHardForkAtVersion"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#TriggerHardForkAtVersion"><span class="hs-identifier">TriggerHardForkAtVersion</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Word16</span><span>
</span><a name="line-163"></a><span>    </span><span class="hs-comment">-- | For testing only, trigger the transition at a specific hard-coded</span><span>
</span><a name="line-164"></a><span>    </span><span class="hs-comment">-- epoch, irrespective of the ledger state.</span><span>
</span><a name="line-165"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TriggerHardForkAtEpoch"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#TriggerHardForkAtEpoch"><span class="hs-identifier">TriggerHardForkAtEpoch</span></a></a><span> </span><span class="hs-glyph">!</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-type">EpochNo</span></a><span>
</span><a name="line-166"></a><span>    </span><span class="hs-comment">-- | Never trigger a hard fork</span><span>
</span><a name="line-167"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TriggerHardForkNever"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#TriggerHardForkNever"><span class="hs-identifier">TriggerHardForkNever</span></a></a><span>
</span><a name="line-168"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#NoUnexpectedThunks"><span class="hs-identifier hs-type">NoUnexpectedThunks</span></a><span class="hs-special">)</span><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span class="hs-comment">-- | When Byron is part of the hard-fork combinator, we use the partial ledger</span><span>
</span><a name="line-171"></a><span class="hs-comment">-- config. Standalone Byron uses the regular ledger config. This means that</span><span>
</span><a name="line-172"></a><span class="hs-comment">-- the partial ledger config is the perfect place to store the trigger</span><span>
</span><a name="line-173"></a><span class="hs-comment">-- condition for the hard fork to Shelley, as we don't have to modify the</span><span>
</span><a name="line-174"></a><span class="hs-comment">-- ledger config for standalone Byron.</span><span>
</span><a name="line-175"></a><span class="hs-keyword">data</span><span> </span><a name="ByronPartialLedgerConfig"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#ByronPartialLedgerConfig"><span class="hs-identifier">ByronPartialLedgerConfig</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ByronPartialLedgerConfig"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#ByronPartialLedgerConfig"><span class="hs-identifier">ByronPartialLedgerConfig</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-176"></a><span>      </span><a name="byronLedgerConfig"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#byronLedgerConfig"><span class="hs-identifier">byronLedgerConfig</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Ledger.Basics.html#LedgerConfig"><span class="hs-identifier hs-type">LedgerConfig</span></a><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="triggerHardFork"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#triggerHardFork"><span class="hs-identifier">triggerHardFork</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#TriggerHardFork"><span class="hs-identifier hs-type">TriggerHardFork</span></a><span>
</span><a name="line-178"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-179"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#NoUnexpectedThunks"><span class="hs-identifier hs-type">NoUnexpectedThunks</span></a><span class="hs-special">)</span><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.PartialConfig.html#HasPartialLedgerConfig"><span class="hs-identifier hs-type">HasPartialLedgerConfig</span></a><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">PartialLedgerConfig</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#ByronPartialLedgerConfig"><span class="hs-identifier hs-type">ByronPartialLedgerConfig</span></a><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span>  </span><a name="local-8214565720323807578"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.PartialConfig.html#completeLedgerConfig"><span class="hs-identifier">completeLedgerConfig</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">byronLedgerConfig</span><span>
</span><a name="line-186"></a><span>
</span><a name="line-187"></a><span class="hs-comment">{-------------------------------------------------------------------------------
  SingleEraBlock Shelley
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Protocol.Crypto.html#TPraosCrypto"><span class="hs-identifier hs-type">TPraosCrypto</span></a><span> </span><a href="#local-6989586621679130393"><span class="hs-identifier hs-type">era</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#SingleEraBlock"><span class="hs-identifier hs-type">SingleEraBlock</span></a><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a><span> </span><a href="#local-6989586621679130393"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-192"></a><span>  </span><span class="hs-comment">-- No transition from Shelley to Goguen yet</span><span>
</span><a name="line-193"></a><span>  </span><a name="local-8214565720323806228"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#singleEraTransition"><span class="hs-identifier">singleEraTransition</span></a></a><span> </span><a name="local-6989586621679130394"><a href="#local-6989586621679130394"><span class="hs-identifier">_cfg</span></a></a><span> </span><a name="local-6989586621679130395"><a href="#local-6989586621679130395"><span class="hs-identifier">_eraParams</span></a></a><span> </span><a name="local-6989586621679130396"><a href="#local-6989586621679130396"><span class="hs-identifier">_eraStart</span></a></a><span> </span><a name="local-6989586621679130397"><a href="#local-6989586621679130397"><span class="hs-identifier">_st</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span>  </span><a name="local-8214565720323806227"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#singleEraInfo"><span class="hs-identifier">singleEraInfo</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Info.html#SingleEraInfo"><span class="hs-identifier hs-var">SingleEraInfo</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-196"></a><span>      </span><span class="hs-identifier">singleEraName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Shelley&quot;</span><span>
</span><a name="line-197"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Protocol.Crypto.html#TPraosCrypto"><span class="hs-identifier hs-type">TPraosCrypto</span></a><span> </span><a href="#local-6989586621679130384"><span class="hs-identifier hs-type">era</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.PartialConfig.html#HasPartialConsensusConfig"><span class="hs-identifier hs-type">HasPartialConsensusConfig</span></a><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Protocol.html#TPraos"><span class="hs-identifier hs-type">TPraos</span></a><span> </span><a href="#local-6989586621679130384"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-200"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">PartialConsensusConfig</span><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Protocol.html#TPraos"><span class="hs-identifier hs-type">TPraos</span></a><span> </span><a href="#local-6989586621679130384"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Protocol.html#TPraosParams"><span class="hs-identifier hs-type">TPraosParams</span></a><span>
</span><a name="line-201"></a><span>
</span><a name="line-202"></a><span>  </span><a name="local-8214565720323807575"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.PartialConfig.html#completeConsensusConfig"><span class="hs-identifier">completeConsensusConfig</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679130385"><a href="#local-6989586621679130385"><span class="hs-identifier">tpraosEpochInfo</span></a></a><span> </span><a name="local-6989586621679130386"><a href="#local-6989586621679130386"><span class="hs-identifier">tpraosParams</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Protocol.html#TPraosConfig"><span class="hs-identifier hs-var">TPraosConfig</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span>
</span><a name="line-203"></a><span>
</span><a name="line-204"></a><span>  </span><span class="hs-comment">-- 'ChainSelConfig' is ()</span><span>
</span><a name="line-205"></a><span>  </span><a name="local-8214565720323807574"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.PartialConfig.html#partialChainSelConfig"><span class="hs-identifier">partialChainSelConfig</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-keyword">newtype</span><span> </span><a name="ShelleyPartialLedgerConfig"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#ShelleyPartialLedgerConfig"><span class="hs-identifier">ShelleyPartialLedgerConfig</span></a></a><span> </span><a name="local-6989586621679130327"><a href="#local-6989586621679130327"><span class="hs-identifier">era</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ShelleyPartialLedgerConfig"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#ShelleyPartialLedgerConfig"><span class="hs-identifier">ShelleyPartialLedgerConfig</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-208"></a><span>      </span><span class="hs-comment">-- | We cache the non-partial ledger config containing a dummy</span><span>
</span><a name="line-209"></a><span>      </span><span class="hs-comment">-- 'EpochInfo' that needs to be replaced with the correct one.</span><span>
</span><a name="line-210"></a><span>      </span><span class="hs-comment">--</span><span>
</span><a name="line-211"></a><span>      </span><span class="hs-comment">-- We do this to avoid recomputing the ledger config each time</span><span>
</span><a name="line-212"></a><span>      </span><span class="hs-comment">-- 'completeLedgerConfig' is called, as 'mkShelleyLedgerConfig' does</span><span>
</span><a name="line-213"></a><span>      </span><span class="hs-comment">-- some rather expensive computations that shouldn't be repeated too</span><span>
</span><a name="line-214"></a><span>      </span><span class="hs-comment">-- often (e.g., 'sgActiveSlotCoeff').</span><span>
</span><a name="line-215"></a><span>      </span><a name="getShelleyPartialLedgerConfig"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#getShelleyPartialLedgerConfig"><span class="hs-identifier">getShelleyPartialLedgerConfig</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Ledger.Ledger.html#ShelleyLedgerConfig"><span class="hs-identifier hs-type">ShelleyLedgerConfig</span></a><span> </span><a href="#local-6989586621679130327"><span class="hs-identifier hs-type">era</span></a><span>
</span><a name="line-216"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-217"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#NoUnexpectedThunks"><span class="hs-identifier hs-type">NoUnexpectedThunks</span></a><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Protocol.Crypto.html#TPraosCrypto"><span class="hs-identifier hs-type">TPraosCrypto</span></a><span> </span><a href="#local-6989586621679130381"><span class="hs-identifier hs-type">era</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.PartialConfig.html#HasPartialLedgerConfig"><span class="hs-identifier hs-type">HasPartialLedgerConfig</span></a><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a><span> </span><a href="#local-6989586621679130381"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-220"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">PartialLedgerConfig</span><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a><span> </span><a href="#local-6989586621679130381"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#ShelleyPartialLedgerConfig"><span class="hs-identifier hs-type">ShelleyPartialLedgerConfig</span></a><span> </span><a href="#local-6989586621679130381"><span class="hs-identifier hs-type">era</span></a><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span>  </span><span class="hs-comment">-- Replace the dummy 'EpochInfo' with the real one</span><span>
</span><a name="line-223"></a><span>  </span><a name="local-8214565720323807578"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.PartialConfig.html#completeLedgerConfig"><span class="hs-identifier">completeLedgerConfig</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679130382"><a href="#local-6989586621679130382"><span class="hs-identifier">epochInfo</span></a></a><span> </span><span class="hs-special">(</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#ShelleyPartialLedgerConfig"><span class="hs-identifier hs-var">ShelleyPartialLedgerConfig</span></a><span> </span><a name="local-6989586621679130383"><a href="#local-6989586621679130383"><span class="hs-identifier">cfg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-224"></a><span>      </span><a href="#local-6989586621679130383"><span class="hs-identifier hs-var">cfg</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-225"></a><span>          </span><span class="hs-identifier">shelleyLedgerGlobals</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">shelleyLedgerGlobals</span><span> </span><a href="#local-6989586621679130383"><span class="hs-identifier hs-var">cfg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-226"></a><span>              </span><span class="hs-identifier">SL.epochInfo</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679130382"><span class="hs-identifier hs-var">epochInfo</span></a><span>
</span><a name="line-227"></a><span>            </span><span class="hs-special">}</span><span>
</span><a name="line-228"></a><span>        </span><span class="hs-special">}</span><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-comment">{-------------------------------------------------------------------------------
  CanHardFork
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-keyword">type</span><span> </span><a name="CardanoHardForkConstraints"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#CardanoHardForkConstraints"><span class="hs-identifier">CardanoHardForkConstraints</span></a></a><span> </span><a name="local-6989586621679130326"><a href="#local-6989586621679130326"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-235"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Protocol.Crypto.html#TPraosCrypto"><span class="hs-identifier hs-type">TPraosCrypto</span></a><span> </span><span class="hs-special">(</span><a href="Ouroboros.Consensus.Cardano.Block.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a><span> </span><a href="#local-6989586621679130326"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-236"></a><span>    </span><span class="hs-comment">-- These equalities allow the transition from Byron to Shelley, since</span><span>
</span><a name="line-237"></a><span>    </span><span class="hs-comment">-- @shelley-spec-ledger@ requires Ed25519 for Byron bootstrap addresses and</span><span>
</span><a name="line-238"></a><span>    </span><span class="hs-comment">-- the current Byron-to-Shelley translation requires a 224-bit hash for</span><span>
</span><a name="line-239"></a><span>    </span><span class="hs-comment">-- address and a 256-bit hash for header hashes.</span><span>
</span><a name="line-240"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">HASH</span><span>     </span><a href="#local-6989586621679130326"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">~</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.Hash.Blake2b.html#Blake2b_256"><span class="hs-identifier hs-type">Blake2b_256</span></a><span>
</span><a name="line-241"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ADDRHASH</span><span> </span><a href="#local-6989586621679130326"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">~</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.Hash.Blake2b.html#Blake2b_224"><span class="hs-identifier hs-type">Blake2b_224</span></a><span>
</span><a name="line-242"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">DSIGN</span><span>    </span><a href="#local-6989586621679130326"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">~</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.DSIGN.Ed25519.html#Ed25519DSIGN"><span class="hs-identifier hs-type">Ed25519DSIGN</span></a><span>
</span><a name="line-243"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span class="hs-keyword">instance</span><span> </span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#CardanoHardForkConstraints"><span class="hs-identifier hs-type">CardanoHardForkConstraints</span></a><span> </span><a href="#local-6989586621679130328"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Abstract.CanHardFork.html#CanHardFork"><span class="hs-identifier hs-type">CanHardFork</span></a><span> </span><span class="hs-special">(</span><a href="Ouroboros.Consensus.Cardano.Block.html#CardanoEras"><span class="hs-identifier hs-type">CardanoEras</span></a><span> </span><a href="#local-6989586621679130328"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-246"></a><span>  </span><a name="local-8214565720323806185"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Abstract.CanHardFork.html#hardForkEraTranslation"><span class="hs-identifier">hardForkEraTranslation</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Translation.html#EraTranslation"><span class="hs-identifier hs-var">EraTranslation</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-247"></a><span>      </span><span class="hs-identifier">translateLedgerState</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.InPairs.html#PCons"><span class="hs-identifier hs-var">PCons</span></a><span> </span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateByronToShelleyWrapper"><span class="hs-identifier hs-var">translateLedgerStateByronToShelleyWrapper</span></a><span>   </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.InPairs.html#PNil"><span class="hs-identifier hs-var">PNil</span></a><span>
</span><a name="line-248"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">translateChainDepState</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.InPairs.html#PCons"><span class="hs-identifier hs-var">PCons</span></a><span> </span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateChainDepStateByronToShelleyWrapper"><span class="hs-identifier hs-var">translateChainDepStateByronToShelleyWrapper</span></a><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.InPairs.html#PNil"><span class="hs-identifier hs-var">PNil</span></a><span>
</span><a name="line-249"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">translateLedgerView</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.InPairs.html#PCons"><span class="hs-identifier hs-var">PCons</span></a><span> </span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerViewByronToShelleyWrapper"><span class="hs-identifier hs-var">translateLedgerViewByronToShelleyWrapper</span></a><span>    </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.InPairs.html#PNil"><span class="hs-identifier hs-var">PNil</span></a><span>
</span><a name="line-250"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-251"></a><span>  </span><a name="local-8214565720323806184"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Abstract.CanHardFork.html#hardForkChainSel"><span class="hs-identifier">hardForkChainSel</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.Tails.html#mk2"><span class="hs-identifier hs-var">Tails.mk2</span></a><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Protocol.ChainSel.html#CompareBlockNo"><span class="hs-identifier hs-var">CompareBlockNo</span></a><span>
</span><a name="line-252"></a><span>  </span><a name="local-8214565720323806183"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Abstract.CanHardFork.html#hardForkInjectTxs"><span class="hs-identifier">hardForkInjectTxs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.InPairs.html#mk2"><span class="hs-identifier hs-var">InPairs.mk2</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.InPairs.html#ignoringBoth"><span class="hs-identifier hs-var">InPairs.ignoringBoth</span></a><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.InjectTxs.html#cannotInjectTx"><span class="hs-identifier hs-var">cannotInjectTx</span></a><span>
</span><a name="line-253"></a><span>
</span><a name="line-254"></a><span class="hs-comment">{-------------------------------------------------------------------------------
  Translation from Byron to Shelley
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span class="hs-identifier">translateHeaderHashByronToShelley</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-259"></a><span>     </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679130413"><a href="#local-6989586621679130413"><span class="hs-identifier">era</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Cardano.Ledger.Era.html#Era"><span class="hs-identifier hs-type">Era</span></a><span> </span><a href="#local-6989586621679130413"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">HASH</span><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Era.Crypto</span></a><span> </span><a href="#local-6989586621679130413"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.Hash.Blake2b.html#Blake2b_256"><span class="hs-identifier hs-type">Blake2b_256</span></a><span class="hs-special">)</span><span>
</span><a name="line-260"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src/Ouroboros.Network.Block.html#HeaderHash"><span class="hs-identifier hs-type">HeaderHash</span></a><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a><span>
</span><a name="line-261"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src/Ouroboros.Network.Block.html#HeaderHash"><span class="hs-identifier hs-type">HeaderHash</span></a><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a><span> </span><a href="#local-6989586621679130413"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">)</span><span>
</span><a name="line-262"></a><a name="translateHeaderHashByronToShelley"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateHeaderHashByronToShelley"><span class="hs-identifier">translateHeaderHashByronToShelley</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-263"></a><span>      </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Block.Abstract.html#fromShortRawHash"><span class="hs-identifier hs-var">fromShortRawHash</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a><span> </span><a href="#local-6989586621679130413"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-264"></a><span>    </span><span class="hs-operator hs-var">.</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Block.Abstract.html#toShortRawHash"><span class="hs-identifier hs-var">toShortRawHash</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a><span class="hs-special">)</span><span>
</span><a name="line-265"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-266"></a><span>    </span><span class="hs-comment">-- Byron uses 'Blake2b_256' for header hashes</span><span>
</span><a name="line-267"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Util.RedundantConstraints.html#keepRedundantConstraint"><span class="hs-identifier hs-var">keepRedundantConstraint</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-type">HASH</span><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Era.Crypto</span></a><span> </span><a href="#local-6989586621679130413"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.Hash.Blake2b.html#Blake2b_256"><span class="hs-identifier hs-type">Blake2b_256</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span class="hs-identifier">translatePointByronToShelley</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-270"></a><span>     </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679130412"><a href="#local-6989586621679130412"><span class="hs-identifier">era</span></a></a><span class="hs-operator">.</span><span>  </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Cardano.Ledger.Era.html#Era"><span class="hs-identifier hs-type">Era</span></a><span> </span><a href="#local-6989586621679130412"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">HASH</span><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Era.Crypto</span></a><span> </span><a href="#local-6989586621679130412"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.Hash.Blake2b.html#Blake2b_256"><span class="hs-identifier hs-type">Blake2b_256</span></a><span class="hs-special">)</span><span>
</span><a name="line-271"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src/Ouroboros.Network.Block.html#Point"><span class="hs-identifier hs-type">Point</span></a><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a><span>
</span><a name="line-272"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src/Cardano.Slotting.Slot.html#WithOrigin"><span class="hs-identifier hs-type">WithOrigin</span></a><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src/Cardano.Slotting.Block.html#BlockNo"><span class="hs-identifier hs-type">BlockNo</span></a><span>
</span><a name="line-273"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src/Cardano.Slotting.Slot.html#WithOrigin"><span class="hs-identifier hs-type">WithOrigin</span></a><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Ledger.Ledger.html#ShelleyTip"><span class="hs-identifier hs-type">ShelleyTip</span></a><span> </span><a href="#local-6989586621679130412"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">)</span><span>
</span><a name="line-274"></a><a name="translatePointByronToShelley"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translatePointByronToShelley"><span class="hs-identifier">translatePointByronToShelley</span></a></a><span> </span><a name="local-6989586621679134448"><a href="#local-6989586621679134448"><span class="hs-identifier">point</span></a></a><span> </span><a name="local-6989586621679134449"><a href="#local-6989586621679134449"><span class="hs-identifier">bNo</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-275"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679134448"><span class="hs-identifier hs-var">point</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679134449"><span class="hs-identifier hs-var">bNo</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-276"></a><span>      </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src/Ouroboros.Network.Block.html#GenesisPoint"><span class="hs-identifier hs-var">GenesisPoint</span></a><span class="hs-special">,</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src/Cardano.Slotting.Slot.html#Origin"><span class="hs-identifier hs-var">Origin</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-277"></a><span>        </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src/Cardano.Slotting.Slot.html#Origin"><span class="hs-identifier hs-var">Origin</span></a><span>
</span><a name="line-278"></a><span>      </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src/Ouroboros.Network.Block.html#BlockPoint"><span class="hs-identifier hs-var">BlockPoint</span></a><span> </span><a name="local-6989586621679134450"><a href="#local-6989586621679134450"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679134451"><a href="#local-6989586621679134451"><span class="hs-identifier">h</span></a></a><span class="hs-special">,</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Block.Abstract.html#NotOrigin"><span class="hs-identifier hs-var">NotOrigin</span></a><span> </span><a name="local-6989586621679134452"><a href="#local-6989586621679134452"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Block.Abstract.html#NotOrigin"><span class="hs-identifier hs-var">NotOrigin</span></a><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Ledger.Ledger.html#ShelleyTip"><span class="hs-identifier hs-var">ShelleyTip</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-279"></a><span>          </span><span class="hs-identifier">shelleyTipSlotNo</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679134450"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-280"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">shelleyTipBlockNo</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679134452"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-281"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">shelleyTipHash</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateHeaderHashByronToShelley"><span class="hs-identifier hs-var">translateHeaderHashByronToShelley</span></a><span> </span><a href="#local-6989586621679134451"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-282"></a><span>        </span><span class="hs-special">}</span><span>
</span><a name="line-283"></a><span>      </span><a name="local-6989586621679134457"><a href="#local-6989586621679134457"><span class="hs-identifier">_otherwise</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-284"></a><span>        </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;translatePointByronToShelley: invalid Byron state&quot;</span><span>
</span><a name="line-285"></a><span>
</span><a name="line-286"></a><span class="hs-identifier">translateLedgerStateByronToShelleyWrapper</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-287"></a><span>     </span><span class="hs-special">(</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Cardano.Ledger.Era.html#Era"><span class="hs-identifier hs-type">Era</span></a><span> </span><a href="#local-6989586621679130411"><span class="hs-identifier hs-type">era</span></a><span>
</span><a name="line-288"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">HASH</span><span>     </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Era.Crypto</span></a><span> </span><a href="#local-6989586621679130411"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.Hash.Blake2b.html#Blake2b_256"><span class="hs-identifier hs-type">Blake2b_256</span></a><span>
</span><a name="line-289"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ADDRHASH</span><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Era.Crypto</span></a><span> </span><a href="#local-6989586621679130411"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.Hash.Blake2b.html#Blake2b_224"><span class="hs-identifier hs-type">Blake2b_224</span></a><span>
</span><a name="line-290"></a><span>     </span><span class="hs-special">)</span><span>
</span><a name="line-291"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.InPairs.html#RequiringBoth"><span class="hs-identifier hs-type">RequiringBoth</span></a><span>
</span><a name="line-292"></a><span>       </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.TypeFamilyWrappers.html#WrapLedgerConfig"><span class="hs-identifier hs-type">WrapLedgerConfig</span></a><span>
</span><a name="line-293"></a><span>       </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.State.Types.html#Translate"><span class="hs-identifier hs-type">Translate</span></a><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Ledger.Basics.html#LedgerState"><span class="hs-identifier hs-type">LedgerState</span></a><span class="hs-special">)</span><span>
</span><a name="line-294"></a><span>       </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a><span>
</span><a name="line-295"></a><span>       </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a><span> </span><a href="#local-6989586621679130411"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">)</span><span>
</span><a name="line-296"></a><a name="translateLedgerStateByronToShelleyWrapper"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateByronToShelleyWrapper"><span class="hs-identifier">translateLedgerStateByronToShelleyWrapper</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-297"></a><span>    </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.InPairs.html#RequireBoth"><span class="hs-identifier hs-var">RequireBoth</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.TypeFamilyWrappers.html#WrapLedgerConfig"><span class="hs-identifier hs-var">WrapLedgerConfig</span></a><span> </span><a name="local-6989586621679134472"><a href="#local-6989586621679134472"><span class="hs-identifier">cfgShelley</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-298"></a><span>    </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.State.Types.html#Translate"><span class="hs-identifier hs-var">Translate</span></a><span>   </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679134473"><a href="#local-6989586621679134473"><span class="hs-identifier">epochNo</span></a></a><span> </span><a name="local-6989586621679134474"><a href="#local-6989586621679134474"><span class="hs-identifier">ledgerByron</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-299"></a><span>      </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Ledger.Ledger.html#ShelleyLedgerState"><span class="hs-identifier hs-var">ShelleyLedgerState</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-300"></a><span>        </span><span class="hs-identifier">shelleyLedgerTip</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-301"></a><span>          </span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translatePointByronToShelley"><span class="hs-identifier hs-var">translatePointByronToShelley</span></a><span>
</span><a name="line-302"></a><span>            </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Ledger.Abstract.html#ledgerTipPoint"><span class="hs-identifier hs-var">ledgerTipPoint</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679134474"><span class="hs-identifier hs-var">ledgerByron</span></a><span class="hs-special">)</span><span>
</span><a name="line-303"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">byronLedgerTipBlockNo</span><span> </span><a href="#local-6989586621679134474"><span class="hs-identifier hs-var">ledgerByron</span></a><span class="hs-special">)</span><span>
</span><a name="line-304"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">shelleyLedgerState</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-305"></a><span>          </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Shelley.Spec.Ledger.ByronTranslation.html#translateToShelleyLedgerState"><span class="hs-identifier hs-var">SL.translateToShelleyLedgerState</span></a><span>
</span><a name="line-306"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">shelleyLedgerGenesis</span><span> </span><a href="#local-6989586621679134472"><span class="hs-identifier hs-var">cfgShelley</span></a><span class="hs-special">)</span><span>
</span><a name="line-307"></a><span>            </span><a href="#local-6989586621679134473"><span class="hs-identifier hs-var">epochNo</span></a><span>
</span><a name="line-308"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">byronLedgerState</span><span> </span><a href="#local-6989586621679134474"><span class="hs-identifier hs-var">ledgerByron</span></a><span class="hs-special">)</span><span>
</span><a name="line-309"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">shelleyLedgerTransition</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-310"></a><span>          </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Ledger.Ledger.html#ShelleyTransitionUnknown"><span class="hs-identifier hs-var">ShelleyTransitionUnknown</span></a><span>
</span><a name="line-311"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-312"></a><span>
</span><a name="line-313"></a><span class="hs-identifier">translateChainDepStateByronToShelleyWrapper</span><span>
</span><a name="line-314"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679130410"><a href="#local-6989586621679130410"><span class="hs-identifier">era</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-315"></a><span>     </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.InPairs.html#RequiringBoth"><span class="hs-identifier hs-type">RequiringBoth</span></a><span>
</span><a name="line-316"></a><span>       </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.TypeFamilyWrappers.html#WrapConsensusConfig"><span class="hs-identifier hs-type">WrapConsensusConfig</span></a><span>
</span><a name="line-317"></a><span>       </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.State.Types.html#Translate"><span class="hs-identifier hs-type">Translate</span></a><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.TypeFamilyWrappers.html#WrapChainDepState"><span class="hs-identifier hs-type">WrapChainDepState</span></a><span class="hs-special">)</span><span>
</span><a name="line-318"></a><span>       </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a><span>
</span><a name="line-319"></a><span>       </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a><span> </span><a href="#local-6989586621679130410"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">)</span><span>
</span><a name="line-320"></a><a name="translateChainDepStateByronToShelleyWrapper"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateChainDepStateByronToShelleyWrapper"><span class="hs-identifier">translateChainDepStateByronToShelleyWrapper</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-321"></a><span>    </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.InPairs.html#RequireBoth"><span class="hs-identifier hs-var">RequireBoth</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.TypeFamilyWrappers.html#WrapConsensusConfig"><span class="hs-identifier hs-var">WrapConsensusConfig</span></a><span> </span><a name="local-6989586621679134482"><a href="#local-6989586621679134482"><span class="hs-identifier">cfgShelley</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-322"></a><span>      </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.State.Types.html#Translate"><span class="hs-identifier hs-var">Translate</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.TypeFamilyWrappers.html#WrapChainDepState"><span class="hs-identifier hs-var">WrapChainDepState</span></a><span> </span><a name="local-6989586621679134483"><a href="#local-6989586621679134483"><span class="hs-identifier">pbftState</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-323"></a><span>        </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.TypeFamilyWrappers.html#WrapChainDepState"><span class="hs-identifier hs-var">WrapChainDepState</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-324"></a><span>          </span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateChainDepStateByronToShelley"><span class="hs-identifier hs-var">translateChainDepStateByronToShelley</span></a><span> </span><a href="#local-6989586621679134482"><span class="hs-identifier hs-var">cfgShelley</span></a><span> </span><a href="#local-6989586621679134483"><span class="hs-identifier hs-var">pbftState</span></a><span>
</span><a name="line-325"></a><span>
</span><a name="line-326"></a><span class="hs-identifier">translateChainDepStateByronToShelley</span><span>
</span><a name="line-327"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679130408"><a href="#local-6989586621679130408"><span class="hs-identifier">bc</span></a></a><span> </span><a name="local-6989586621679130409"><a href="#local-6989586621679130409"><span class="hs-identifier">era</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-328"></a><span>     </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Protocol.Abstract.html#ConsensusConfig"><span class="hs-identifier hs-type">ConsensusConfig</span></a><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Protocol.html#TPraos"><span class="hs-identifier hs-type">TPraos</span></a><span> </span><a href="#local-6989586621679130409"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">)</span><span>
</span><a name="line-329"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Protocol.PBFT.State.html#PBftState"><span class="hs-identifier hs-type">PBftState</span></a><span> </span><a href="#local-6989586621679130408"><span class="hs-identifier hs-type">bc</span></a><span>
</span><a name="line-330"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Protocol.html#TPraosState"><span class="hs-identifier hs-type">TPraosState</span></a><span> </span><a href="#local-6989586621679130409"><span class="hs-identifier hs-type">era</span></a><span>
</span><a name="line-331"></a><a name="translateChainDepStateByronToShelley"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateChainDepStateByronToShelley"><span class="hs-identifier">translateChainDepStateByronToShelley</span></a></a><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Protocol.html#TPraosConfig"><span class="hs-identifier hs-var">TPraosConfig</span></a><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679134484"><a href="#local-6989586621679134484"><span class="hs-identifier">tpraosParams</span></a></a><span> </span><span class="hs-special">}</span><span> </span><a name="local-6989586621679134485"><a href="#local-6989586621679134485"><span class="hs-identifier">pbftState</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-332"></a><span>    </span><span class="hs-comment">-- Note that the 'PBftState' doesn't know about EBBs. So if the last slot of</span><span>
</span><a name="line-333"></a><span>    </span><span class="hs-comment">-- the Byron era were occupied by an EBB (and no regular block in that same</span><span>
</span><a name="line-334"></a><span>    </span><span class="hs-comment">-- slot), we would pick the wrong slot here, i.e., the slot of the regular</span><span>
</span><a name="line-335"></a><span>    </span><span class="hs-comment">-- block before the EBB.</span><span>
</span><a name="line-336"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-337"></a><span>    </span><span class="hs-comment">-- Fortunately, this is impossible for two reasons:</span><span>
</span><a name="line-338"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-339"></a><span>    </span><span class="hs-comment">-- 1. On mainnet we stopped producing EBBs a while before the transition.</span><span>
</span><a name="line-340"></a><span>    </span><span class="hs-comment">-- 2. The transition happens at the start of an epoch, so if the last slot</span><span>
</span><a name="line-341"></a><span>    </span><span class="hs-comment">--    were occupied by an EBB, it must have been the EBB at the start of the</span><span>
</span><a name="line-342"></a><span>    </span><span class="hs-comment">--    previous epoch. This means the previous epoch must have been empty,</span><span>
</span><a name="line-343"></a><span>    </span><span class="hs-comment">--    which is a violation of the &quot;@k@ blocks per @2k@ slots&quot; property.</span><span>
</span><a name="line-344"></a><span>    </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Protocol.html#TPraosState"><span class="hs-identifier hs-var">TPraosState</span></a><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.Protocol.PBFT.State.html#lastSignedSlot"><span class="hs-identifier hs-var">PBftState.lastSignedSlot</span></a><span> </span><a href="#local-6989586621679134485"><span class="hs-identifier hs-var">pbftState</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-345"></a><span>      </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Shelley.Spec.Ledger.API.Protocol.html#ChainDepState"><span class="hs-identifier hs-var">SL.ChainDepState</span></a><span>
</span><a name="line-346"></a><span>        </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">SL.csProtocol</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Shelley.Spec.Ledger.STS.Prtcl.html#PrtclState"><span class="hs-identifier hs-var">SL.PrtclState</span></a><span> </span><span class="hs-identifier hs-var">Map.empty</span><span> </span><a href="#local-6989586621679134486"><span class="hs-identifier hs-var">nonce</span></a><span> </span><a href="#local-6989586621679134486"><span class="hs-identifier hs-var">nonce</span></a><span>
</span><a name="line-347"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SL.csTickn</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Shelley.Spec.Ledger.STS.Tickn.html#TicknState"><span class="hs-identifier hs-var">SL.TicknState</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-348"></a><span>              </span><span class="hs-identifier">ticknStateEpochNonce</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679134486"><span class="hs-identifier hs-var">nonce</span></a><span>
</span><a name="line-349"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ticknStatePrevHashNonce</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Shelley.Spec.Ledger.BaseTypes.html#NeutralNonce"><span class="hs-identifier hs-var">SL.NeutralNonce</span></a><span>
</span><a name="line-350"></a><span>            </span><span class="hs-special">}</span><span>
</span><a name="line-351"></a><span>          </span><span class="hs-comment">-- Overridden before used</span><span>
</span><a name="line-352"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SL.csLabNonce</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Shelley.Spec.Ledger.BaseTypes.html#NeutralNonce"><span class="hs-identifier hs-var">SL.NeutralNonce</span></a><span>
</span><a name="line-353"></a><span>        </span><span class="hs-special">}</span><span>
</span><a name="line-354"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-355"></a><span>    </span><a name="local-6989586621679134486"><a href="#local-6989586621679134486"><span class="hs-identifier">nonce</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tpraosInitialNonce</span><span> </span><a href="#local-6989586621679134484"><span class="hs-identifier hs-var">tpraosParams</span></a><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span class="hs-identifier">translateLedgerViewByronToShelleyWrapper</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-358"></a><span>     </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679130407"><a href="#local-6989586621679130407"><span class="hs-identifier">era</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-359"></a><span>     </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.InPairs.html#RequiringBoth"><span class="hs-identifier hs-type">RequiringBoth</span></a><span>
</span><a name="line-360"></a><span>       </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.TypeFamilyWrappers.html#WrapLedgerConfig"><span class="hs-identifier hs-type">WrapLedgerConfig</span></a><span>
</span><a name="line-361"></a><span>       </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.State.Types.html#TranslateForecast"><span class="hs-identifier hs-type">TranslateForecast</span></a><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.TypeFamilyWrappers.html#WrapLedgerView"><span class="hs-identifier hs-type">WrapLedgerView</span></a><span class="hs-special">)</span><span>
</span><a name="line-362"></a><span>       </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src/Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a><span>
</span><a name="line-363"></a><span>       </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a><span> </span><a href="#local-6989586621679130407"><span class="hs-identifier hs-type">era</span></a><span class="hs-special">)</span><span>
</span><a name="line-364"></a><a name="translateLedgerViewByronToShelleyWrapper"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerViewByronToShelleyWrapper"><span class="hs-identifier">translateLedgerViewByronToShelleyWrapper</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-365"></a><span>    </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.Util.InPairs.html#RequireBoth"><span class="hs-identifier hs-var">RequireBoth</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.TypeFamilyWrappers.html#WrapLedgerConfig"><span class="hs-identifier hs-var">WrapLedgerConfig</span></a><span> </span><a name="local-6989586621679134494"><a href="#local-6989586621679134494"><span class="hs-identifier">cfgShelley</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-366"></a><span>      </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.HardFork.Combinator.State.Types.html#TranslateForecast"><span class="hs-identifier hs-var">TranslateForecast</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679134495"><a href="#local-6989586621679134495"><span class="hs-identifier">_epochNo</span></a></a><span> </span><a name="local-6989586621679134496"><a href="#local-6989586621679134496"><span class="hs-identifier">_forecastFor</span></a></a><span> </span><a name="local-6989586621679134497"><a href="#local-6989586621679134497"><span class="hs-identifier">_finalByronView</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-367"></a><span>        </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src/Ouroboros.Consensus.TypeFamilyWrappers.html#WrapTickedLedgerView"><span class="hs-identifier hs-var">WrapTickedLedgerView</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-368"></a><span>          </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-consensus-shelley-0.1.0.0/noopt/doc/html/ouroboros-consensus-shelley/src/Ouroboros.Consensus.Shelley.Protocol.html#TickedPraosLedgerView"><span class="hs-identifier hs-var">TickedPraosLedgerView</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-369"></a><span>            </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src/Shelley.Spec.Ledger.ByronTranslation.html#mkInitialShelleyLedgerView"><span class="hs-identifier hs-var">SL.mkInitialShelleyLedgerView</span></a><span>
</span><a name="line-370"></a><span>              </span><span class="hs-special">(</span><span class="hs-identifier">shelleyLedgerGenesis</span><span> </span><a href="#local-6989586621679134494"><span class="hs-identifier hs-var">cfgShelley</span></a><span class="hs-special">)</span><span>
</span><a name="line-371"></a></pre></body></html>