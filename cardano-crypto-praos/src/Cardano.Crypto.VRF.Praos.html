<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE DerivingVia #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-11"></a><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><a name="line-12"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a name="line-13"></a><span class="hs-pragma">{-# LANGUAGE ForeignFunctionInterface #-}</span><span>
</span><a name="line-14"></a><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-comment">-- | Verifiable Random Function (VRF) implemented as FFI wrappers around the</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- implementation in https://github.com/input-output-hk/libsodium</span><span>
</span><a name="line-18"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Crypto.VRF.Praos</span><span>
</span><a name="line-19"></a><span>  </span><span class="hs-special">(</span><span>
</span><a name="line-20"></a><span>  </span><span class="hs-comment">-- * VRFAlgorithm API</span><span>
</span><a name="line-21"></a><span>    </span><a href="Cardano.Crypto.VRF.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span>  </span><span class="hs-comment">-- * Low-level size specifiers</span><span>
</span><a name="line-24"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-25"></a><span>  </span><span class="hs-comment">-- Sizes of various value types involved in the VRF calculations. Users of</span><span>
</span><a name="line-26"></a><span>  </span><span class="hs-comment">-- this module will not need these, we are only exporting them for unit</span><span>
</span><a name="line-27"></a><span>  </span><span class="hs-comment">-- testing purposes.</span><span>
</span><a name="line-28"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_proofbytes"><span class="hs-identifier hs-var">crypto_vrf_proofbytes</span></a><span>
</span><a name="line-29"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_publickeybytes"><span class="hs-identifier hs-var">crypto_vrf_publickeybytes</span></a><span>
</span><a name="line-30"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_secretkeybytes"><span class="hs-identifier hs-var">crypto_vrf_secretkeybytes</span></a><span>
</span><a name="line-31"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_seedbytes"><span class="hs-identifier hs-var">crypto_vrf_seedbytes</span></a><span>
</span><a name="line-32"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_outputbytes"><span class="hs-identifier hs-var">crypto_vrf_outputbytes</span></a><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span>  </span><span class="hs-comment">-- * Key sizes</span><span>
</span><a name="line-35"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#certSizeVRF"><span class="hs-identifier hs-var">certSizeVRF</span></a><span>
</span><a name="line-36"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#signKeySizeVRF"><span class="hs-identifier hs-var">signKeySizeVRF</span></a><span>
</span><a name="line-37"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#verKeySizeVRF"><span class="hs-identifier hs-var">verKeySizeVRF</span></a><span>
</span><a name="line-38"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#vrfKeySizeVRF"><span class="hs-identifier hs-var">vrfKeySizeVRF</span></a><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span>  </span><span class="hs-comment">-- * Seed and key generation</span><span>
</span><a name="line-41"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Seed"><span class="hs-identifier hs-type">Seed</span></a><span>
</span><a name="line-42"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#genSeed"><span class="hs-identifier hs-var">genSeed</span></a><span>
</span><a name="line-43"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#keypairFromSeed"><span class="hs-identifier hs-var">keypairFromSeed</span></a><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span>  </span><span class="hs-comment">-- * Conversions</span><span>
</span><a name="line-46"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#unsafeRawSeed"><span class="hs-identifier hs-var">unsafeRawSeed</span></a><span>
</span><a name="line-47"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#outputBytes"><span class="hs-identifier hs-var">outputBytes</span></a><span>
</span><a name="line-48"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#proofBytes"><span class="hs-identifier hs-var">proofBytes</span></a><span>
</span><a name="line-49"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#skBytes"><span class="hs-identifier hs-var">skBytes</span></a><span>
</span><a name="line-50"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#vkBytes"><span class="hs-identifier hs-var">vkBytes</span></a><span>
</span><a name="line-51"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#skToVerKey"><span class="hs-identifier hs-var">skToVerKey</span></a><span>
</span><a name="line-52"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#skToSeed"><span class="hs-identifier hs-var">skToSeed</span></a><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span>  </span><span class="hs-comment">-- * Core VRF operations</span><span>
</span><a name="line-55"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#prove"><span class="hs-identifier hs-var">prove</span></a><span>
</span><a name="line-56"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#verify"><span class="hs-identifier hs-var">verify</span></a><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#SignKeyVRF"><span class="hs-identifier hs-type">SignKeyVRF</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#VerKeyVRF"><span class="hs-identifier hs-type">VerKeyVRF</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#CertVRF"><span class="hs-identifier hs-type">CertVRF</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span class="hs-keyword">where</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.html"><span class="hs-identifier">Cardano.Binary</span></a><span>
</span><a name="line-65"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.FromCBOR.html#FromCBOR"><span class="hs-identifier hs-type">FromCBOR</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#ToCBOR"><span class="hs-identifier hs-type">ToCBOR</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-keyword">import</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html"><span class="hs-identifier">Cardano.Crypto.VRF.Class</span></a><span>
</span><a name="line-70"></a><span class="hs-keyword">import</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.Seed.html"><span class="hs-identifier">Cardano.Crypto.Seed</span></a><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.Seed.html#getBytesFromSeedT"><span class="hs-identifier hs-var">getBytesFromSeedT</span></a><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span class="hs-keyword">import</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.Util.html"><span class="hs-identifier">Cardano.Crypto.Util</span></a><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.Util.html#SignableRepresentation"><span class="hs-identifier hs-type">SignableRepresentation</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-keyword">import</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.html"><span class="hs-identifier">Cardano.Prelude</span></a><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#NoUnexpectedThunks"><span class="hs-identifier hs-type">NoUnexpectedThunks</span></a><span class="hs-special">,</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#OnlyCheckIsWHNF"><span class="hs-identifier hs-type">OnlyCheckIsWHNF</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Generics</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Coerce</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">coerce</span><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign.ForeignPtr</span><span>
</span><a name="line-78"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign.C.Types</span><span>
</span><a name="line-79"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign.Ptr</span><span>
</span><a name="line-80"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign.Marshal.Alloc</span><span>
</span><a name="line-81"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign.Marshal.Utils</span><span>
</span><a name="line-82"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.IO.Unsafe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unsafePerformIO</span><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">void</span><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.ByteString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteString</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BS</span><span>
</span><a name="line-86"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isJust</span><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Proxy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Proxy</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-comment">-- Value types.</span><span>
</span><a name="line-90"></a><span class="hs-comment">--</span><span>
</span><a name="line-91"></a><span class="hs-comment">-- These are all transparent to the Haskell side of things, all we ever do</span><span>
</span><a name="line-92"></a><span class="hs-comment">-- with these is pass pointers to them around. We don't want to know anything</span><span>
</span><a name="line-93"></a><span class="hs-comment">-- about them, hence, we make them uninhabited.</span><span>
</span><a name="line-94"></a><span class="hs-comment">--</span><span>
</span><a name="line-95"></a><span class="hs-comment">-- The actual values are kept entirely in C memory, allocated when a value is</span><span>
</span><a name="line-96"></a><span class="hs-comment">-- created, and freed when the value's finalizer runs.</span><span>
</span><a name="line-97"></a><span class="hs-comment">--</span><span>
</span><a name="line-98"></a><span class="hs-comment">-- The reason we have them at all, rather than duplicating C's void pointers,</span><span>
</span><a name="line-99"></a><span class="hs-comment">-- is because we want to distinguish them at the type level.</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-keyword">data</span><span> </span><a name="SeedValue"><a href="Cardano.Crypto.VRF.Praos.html#SeedValue"><span class="hs-identifier">SeedValue</span></a></a><span>
</span><a name="line-102"></a><span class="hs-keyword">data</span><span> </span><a name="SignKeyValue"><a href="Cardano.Crypto.VRF.Praos.html#SignKeyValue"><span class="hs-identifier">SignKeyValue</span></a></a><span>
</span><a name="line-103"></a><span class="hs-keyword">data</span><span> </span><a name="VerKeyValue"><a href="Cardano.Crypto.VRF.Praos.html#VerKeyValue"><span class="hs-identifier">VerKeyValue</span></a></a><span>
</span><a name="line-104"></a><span class="hs-keyword">data</span><span> </span><a name="ProofValue"><a href="Cardano.Crypto.VRF.Praos.html#ProofValue"><span class="hs-identifier">ProofValue</span></a></a><span>
</span><a name="line-105"></a><span class="hs-keyword">data</span><span> </span><a name="OutputValue"><a href="Cardano.Crypto.VRF.Praos.html#OutputValue"><span class="hs-identifier">OutputValue</span></a></a><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">-- Type aliases for raw pointers</span><span>
</span><a name="line-108"></a><span class="hs-comment">--</span><span>
</span><a name="line-109"></a><span class="hs-comment">-- These will not leave this module, they are only here for our convenience,</span><span>
</span><a name="line-110"></a><span class="hs-comment">-- so we can afford to not newtype them.</span><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-keyword">type</span><span> </span><a name="SeedPtr"><a href="Cardano.Crypto.VRF.Praos.html#SeedPtr"><span class="hs-identifier">SeedPtr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SeedValue"><span class="hs-identifier hs-type">SeedValue</span></a><span>
</span><a name="line-113"></a><span class="hs-keyword">type</span><span> </span><a name="SignKeyPtr"><a href="Cardano.Crypto.VRF.Praos.html#SignKeyPtr"><span class="hs-identifier">SignKeyPtr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKeyValue"><span class="hs-identifier hs-type">SignKeyValue</span></a><span>
</span><a name="line-114"></a><span class="hs-keyword">type</span><span> </span><a name="VerKeyPtr"><a href="Cardano.Crypto.VRF.Praos.html#VerKeyPtr"><span class="hs-identifier">VerKeyPtr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKeyValue"><span class="hs-identifier hs-type">VerKeyValue</span></a><span>
</span><a name="line-115"></a><span class="hs-keyword">type</span><span> </span><a name="ProofPtr"><a href="Cardano.Crypto.VRF.Praos.html#ProofPtr"><span class="hs-identifier">ProofPtr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#ProofValue"><span class="hs-identifier hs-type">ProofValue</span></a><span>
</span><a name="line-116"></a><span class="hs-keyword">type</span><span> </span><a name="OutputPtr"><a href="Cardano.Crypto.VRF.Praos.html#OutputPtr"><span class="hs-identifier">OutputPtr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#OutputValue"><span class="hs-identifier hs-type">OutputValue</span></a><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">-- The exported (via the 'VRFAlgorithm' typeclass) types.</span><span>
</span><a name="line-119"></a><span class="hs-comment">--</span><span>
</span><a name="line-120"></a><span class="hs-comment">-- These are wrappers around 'ForeignPtr's; we don't export the constructors,</span><span>
</span><a name="line-121"></a><span class="hs-comment">-- so callers have to go through our blessed API to create any of them. This</span><span>
</span><a name="line-122"></a><span class="hs-comment">-- way we can make sure that we always allocate the correct sizes, and attach</span><span>
</span><a name="line-123"></a><span class="hs-comment">-- finalizers that automatically free the memory for us.</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-comment">-- | A random seed, used to derive a key pair.</span><span>
</span><a name="line-126"></a><span class="hs-keyword">newtype</span><span> </span><a name="Seed"><a href="Cardano.Crypto.VRF.Praos.html#Seed"><span class="hs-identifier">Seed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Seed"><a href="Cardano.Crypto.VRF.Praos.html#Seed"><span class="hs-identifier">Seed</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unSeed"><a href="Cardano.Crypto.VRF.Praos.html#unSeed"><span class="hs-identifier">unSeed</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ForeignPtr</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SeedValue"><span class="hs-identifier hs-type">SeedValue</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-127"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#NoUnexpectedThunks"><span class="hs-identifier hs-type">NoUnexpectedThunks</span></a><span> </span><span class="hs-keyword">via</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#OnlyCheckIsWHNF"><span class="hs-identifier hs-type">OnlyCheckIsWHNF</span></a><span> </span><span class="hs-string">&quot;Seed&quot;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Seed"><span class="hs-identifier hs-type">Seed</span></a><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span class="hs-comment">-- | Signing key. In this implementation, the signing key is actually a 64-byte</span><span>
</span><a name="line-130"></a><span class="hs-comment">-- value that contains both the 32-byte signing key and the corresponding</span><span>
</span><a name="line-131"></a><span class="hs-comment">-- 32-byte verification key.</span><span>
</span><a name="line-132"></a><span class="hs-keyword">newtype</span><span> </span><a name="SignKey"><a href="Cardano.Crypto.VRF.Praos.html#SignKey"><span class="hs-identifier">SignKey</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SignKey"><a href="Cardano.Crypto.VRF.Praos.html#SignKey"><span class="hs-identifier">SignKey</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unSignKey"><a href="Cardano.Crypto.VRF.Praos.html#unSignKey"><span class="hs-identifier">unSignKey</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ForeignPtr</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKeyValue"><span class="hs-identifier hs-type">SignKeyValue</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-133"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#NoUnexpectedThunks"><span class="hs-identifier hs-type">NoUnexpectedThunks</span></a><span> </span><span class="hs-keyword">via</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#OnlyCheckIsWHNF"><span class="hs-identifier hs-type">OnlyCheckIsWHNF</span></a><span> </span><span class="hs-string">&quot;SignKey&quot;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKey"><span class="hs-identifier hs-type">SignKey</span></a><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- | Verification key.</span><span>
</span><a name="line-137"></a><span class="hs-keyword">newtype</span><span> </span><a name="VerKey"><a href="Cardano.Crypto.VRF.Praos.html#VerKey"><span class="hs-identifier">VerKey</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="VerKey"><a href="Cardano.Crypto.VRF.Praos.html#VerKey"><span class="hs-identifier">VerKey</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unVerKey"><a href="Cardano.Crypto.VRF.Praos.html#unVerKey"><span class="hs-identifier">unVerKey</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ForeignPtr</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKeyValue"><span class="hs-identifier hs-type">VerKeyValue</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-138"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#NoUnexpectedThunks"><span class="hs-identifier hs-type">NoUnexpectedThunks</span></a><span> </span><span class="hs-keyword">via</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#OnlyCheckIsWHNF"><span class="hs-identifier hs-type">OnlyCheckIsWHNF</span></a><span> </span><span class="hs-string">&quot;VerKey&quot;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKey"><span class="hs-identifier hs-type">VerKey</span></a><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-comment">-- | A proof, as constructed by the 'prove' function.</span><span>
</span><a name="line-142"></a><span class="hs-keyword">newtype</span><span> </span><a name="Proof"><a href="Cardano.Crypto.VRF.Praos.html#Proof"><span class="hs-identifier">Proof</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Proof"><a href="Cardano.Crypto.VRF.Praos.html#Proof"><span class="hs-identifier">Proof</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unProof"><a href="Cardano.Crypto.VRF.Praos.html#unProof"><span class="hs-identifier">unProof</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ForeignPtr</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#ProofValue"><span class="hs-identifier hs-type">ProofValue</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-143"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#NoUnexpectedThunks"><span class="hs-identifier hs-type">NoUnexpectedThunks</span></a><span> </span><span class="hs-keyword">via</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#OnlyCheckIsWHNF"><span class="hs-identifier hs-type">OnlyCheckIsWHNF</span></a><span> </span><span class="hs-string">&quot;Proof&quot;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Proof"><span class="hs-identifier hs-type">Proof</span></a><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-comment">-- | Hashed output of a proof verification, as returned by the 'verify'</span><span>
</span><a name="line-147"></a><span class="hs-comment">-- function.</span><span>
</span><a name="line-148"></a><span class="hs-keyword">newtype</span><span> </span><a name="Output"><a href="Cardano.Crypto.VRF.Praos.html#Output"><span class="hs-identifier">Output</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Output"><a href="Cardano.Crypto.VRF.Praos.html#Output"><span class="hs-identifier">Output</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unOutput"><a href="Cardano.Crypto.VRF.Praos.html#unOutput"><span class="hs-identifier">unOutput</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ForeignPtr</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#OutputValue"><span class="hs-identifier hs-type">OutputValue</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-149"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#NoUnexpectedThunks"><span class="hs-identifier hs-type">NoUnexpectedThunks</span></a><span> </span><span class="hs-keyword">via</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#OnlyCheckIsWHNF"><span class="hs-identifier hs-type">OnlyCheckIsWHNF</span></a><span> </span><span class="hs-string">&quot;Output&quot;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Output"><span class="hs-identifier hs-type">Output</span></a><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-comment">-- Raw low-level FFI bindings.</span><span>
</span><a name="line-153"></a><span class="hs-comment">--</span><span>
</span><a name="line-154"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-string">&quot;crypto_vrf_proofbytes&quot;</span><span> </span><span class="hs-identifier">crypto_vrf_proofbytes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CSize</span><span>
</span><a name="line-155"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-string">&quot;crypto_vrf_publickeybytes&quot;</span><span> </span><span class="hs-identifier">crypto_vrf_publickeybytes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CSize</span><span>
</span><a name="line-156"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-string">&quot;crypto_vrf_secretkeybytes&quot;</span><span> </span><span class="hs-identifier">crypto_vrf_secretkeybytes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CSize</span><span>
</span><a name="line-157"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-string">&quot;crypto_vrf_seedbytes&quot;</span><span> </span><span class="hs-identifier">crypto_vrf_seedbytes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CSize</span><span>
</span><a name="line-158"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-string">&quot;crypto_vrf_outputbytes&quot;</span><span> </span><span class="hs-identifier">crypto_vrf_outputbytes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CSize</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-string">&quot;crypto_vrf_keypair_from_seed&quot;</span><span> </span><span class="hs-identifier">crypto_vrf_keypair_from_seed</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKeyPtr"><span class="hs-identifier hs-type">VerKeyPtr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKeyPtr"><span class="hs-identifier hs-type">SignKeyPtr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SeedPtr"><span class="hs-identifier hs-type">SeedPtr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CInt</span><span>
</span><a name="line-161"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-string">&quot;crypto_vrf_sk_to_pk&quot;</span><span> </span><span class="hs-identifier">crypto_vrf_sk_to_pk</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKeyPtr"><span class="hs-identifier hs-type">VerKeyPtr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKeyPtr"><span class="hs-identifier hs-type">SignKeyPtr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CInt</span><span>
</span><a name="line-162"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-string">&quot;crypto_vrf_sk_to_seed&quot;</span><span> </span><span class="hs-identifier">crypto_vrf_sk_to_seed</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SeedPtr"><span class="hs-identifier hs-type">SeedPtr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKeyPtr"><span class="hs-identifier hs-type">SignKeyPtr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CInt</span><span>
</span><a name="line-163"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-string">&quot;crypto_vrf_prove&quot;</span><span> </span><span class="hs-identifier">crypto_vrf_prove</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#ProofPtr"><span class="hs-identifier hs-type">ProofPtr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKeyPtr"><span class="hs-identifier hs-type">SignKeyPtr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">CChar</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CULLong</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CInt</span><span>
</span><a name="line-164"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-string">&quot;crypto_vrf_verify&quot;</span><span> </span><span class="hs-identifier">crypto_vrf_verify</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#OutputPtr"><span class="hs-identifier hs-type">OutputPtr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKeyPtr"><span class="hs-identifier hs-type">VerKeyPtr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#ProofPtr"><span class="hs-identifier hs-type">ProofPtr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">CChar</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CULLong</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CInt</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-string">&quot;crypto_vrf_proof_to_hash&quot;</span><span> </span><span class="hs-identifier">crypto_vrf_proof_to_hash</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#OutputPtr"><span class="hs-identifier hs-type">OutputPtr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#ProofPtr"><span class="hs-identifier hs-type">ProofPtr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CInt</span><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-string">&quot;randombytes_buf&quot;</span><span> </span><span class="hs-identifier">randombytes_buf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="#local-6989586621679044935"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CSize</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span class="hs-comment">-- Key size constants</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-identifier">certSizeVRF</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-173"></a><a name="certSizeVRF"><a href="Cardano.Crypto.VRF.Praos.html#certSizeVRF"><span class="hs-identifier">certSizeVRF</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_proofbytes"><span class="hs-identifier hs-var">crypto_vrf_proofbytes</span></a><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span class="hs-identifier">signKeySizeVRF</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-176"></a><a name="signKeySizeVRF"><a href="Cardano.Crypto.VRF.Praos.html#signKeySizeVRF"><span class="hs-identifier">signKeySizeVRF</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_secretkeybytes"><span class="hs-identifier hs-var">crypto_vrf_secretkeybytes</span></a><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-identifier">verKeySizeVRF</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-179"></a><a name="verKeySizeVRF"><a href="Cardano.Crypto.VRF.Praos.html#verKeySizeVRF"><span class="hs-identifier">verKeySizeVRF</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_publickeybytes"><span class="hs-identifier hs-var">crypto_vrf_publickeybytes</span></a><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-identifier">vrfKeySizeVRF</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-182"></a><a name="vrfKeySizeVRF"><a href="Cardano.Crypto.VRF.Praos.html#vrfKeySizeVRF"><span class="hs-identifier">vrfKeySizeVRF</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_outputbytes"><span class="hs-identifier hs-var">crypto_vrf_outputbytes</span></a><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-comment">-- | Allocate a 'Seed' and attach a finalizer. The allocated memory will not be initialized.</span><span>
</span><a name="line-185"></a><span class="hs-identifier">mkSeed</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Seed"><span class="hs-identifier hs-type">Seed</span></a><span>
</span><a name="line-186"></a><a name="mkSeed"><a href="Cardano.Crypto.VRF.Praos.html#mkSeed"><span class="hs-identifier">mkSeed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-187"></a><span>  </span><a name="local-6989586621679044818"><a href="#local-6989586621679044818"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mallocBytes</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_seedbytes"><span class="hs-identifier hs-var">crypto_vrf_seedbytes</span></a><span class="hs-special">)</span><span>
</span><a name="line-188"></a><span>  </span><a href="Cardano.Crypto.VRF.Praos.html#Seed"><span class="hs-identifier hs-var">Seed</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">newForeignPtr</span><span> </span><span class="hs-identifier hs-var">finalizerFree</span><span> </span><a href="#local-6989586621679044818"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span class="hs-comment">-- | Generate a random seed.</span><span>
</span><a name="line-191"></a><span class="hs-comment">-- Uses 'randombytes_buf' to create random data.</span><span>
</span><a name="line-192"></a><span class="hs-comment">--</span><span>
</span><a name="line-193"></a><span class="hs-comment">-- This function provides an alternative way of generating seeds specifically</span><span>
</span><a name="line-194"></a><span class="hs-comment">-- for the 'PraosVRF' algorithm. Unlike the 'genKeyPairVRF' method, which uses</span><span>
</span><a name="line-195"></a><span class="hs-comment">-- a 'ByteString'-based 'Cardano.Crypto.Seed.Seed', this seed generation method</span><span>
</span><a name="line-196"></a><span class="hs-comment">-- bypasses the GHC heap, keeping the seed in C-allocated memory instead.</span><span>
</span><a name="line-197"></a><span class="hs-comment">--</span><span>
</span><a name="line-198"></a><span class="hs-comment">-- This provides two advantages:</span><span>
</span><a name="line-199"></a><span class="hs-comment">-- 1. It avoids the overhead of unnecessary GHC-side heap allocations.</span><span>
</span><a name="line-200"></a><span class="hs-comment">-- 2. It avoids leaking the seed via the GHC heap; the 'Seed' type itself</span><span>
</span><a name="line-201"></a><span class="hs-comment">--    takes care of zeroing out its memory upon finalization.</span><span>
</span><a name="line-202"></a><span class="hs-identifier">genSeed</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Seed"><span class="hs-identifier hs-type">Seed</span></a><span>
</span><a name="line-203"></a><a name="genSeed"><a href="Cardano.Crypto.VRF.Praos.html#genSeed"><span class="hs-identifier">genSeed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-204"></a><span>  </span><a name="local-6989586621679044850"><a href="#local-6989586621679044850"><span class="hs-identifier">seed</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#mkSeed"><span class="hs-identifier hs-var">mkSeed</span></a><span>
</span><a name="line-205"></a><span>  </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unSeed</span><span> </span><a href="#local-6989586621679044850"><span class="hs-identifier hs-var">seed</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044851"><a href="#local-6989586621679044851"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-206"></a><span>    </span><a href="Cardano.Crypto.VRF.Praos.html#randombytes_buf"><span class="hs-identifier hs-var">randombytes_buf</span></a><span> </span><a href="#local-6989586621679044851"><span class="hs-identifier hs-var">ptr</span></a><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_seedbytes"><span class="hs-identifier hs-var">crypto_vrf_seedbytes</span></a><span>
</span><a name="line-207"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679044850"><span class="hs-identifier hs-var">seed</span></a><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-identifier">copyFromByteString</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="#local-6989586621679044817"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-210"></a><a name="copyFromByteString"><a href="Cardano.Crypto.VRF.Praos.html#copyFromByteString"><span class="hs-identifier">copyFromByteString</span></a></a><span> </span><a name="local-6989586621679044852"><a href="#local-6989586621679044852"><span class="hs-identifier">ptr</span></a></a><span> </span><a name="local-6989586621679044853"><a href="#local-6989586621679044853"><span class="hs-identifier">bs</span></a></a><span> </span><a name="local-6989586621679044854"><a href="#local-6989586621679044854"><span class="hs-identifier">lenExpected</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-211"></a><span>  </span><span class="hs-identifier hs-var">BS.useAsCStringLen</span><span> </span><a href="#local-6989586621679044853"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679044855"><a href="#local-6989586621679044855"><span class="hs-identifier">cstr</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679044856"><a href="#local-6989586621679044856"><span class="hs-identifier">lenActual</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-212"></a><span>    </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679044856"><span class="hs-identifier hs-var">lenActual</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679044854"><span class="hs-identifier hs-var">lenExpected</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-213"></a><span>      </span><span class="hs-identifier hs-var">copyBytes</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">castPtr</span><span> </span><a href="#local-6989586621679044852"><span class="hs-identifier hs-var">ptr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679044855"><span class="hs-identifier hs-var">cstr</span></a><span> </span><a href="#local-6989586621679044854"><span class="hs-identifier hs-var">lenExpected</span></a><span>
</span><a name="line-214"></a><span>    </span><span class="hs-keyword">else</span><span>
</span><a name="line-215"></a><span>      </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Invalid input size, expected at least &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679044854"><span class="hs-identifier hs-var">lenExpected</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;, but got &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679044856"><span class="hs-identifier hs-var">lenActual</span></a><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span class="hs-identifier">seedFromBytes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Seed"><span class="hs-identifier hs-type">Seed</span></a><span>
</span><a name="line-218"></a><a name="seedFromBytes"><a href="Cardano.Crypto.VRF.Praos.html#seedFromBytes"><span class="hs-identifier">seedFromBytes</span></a></a><span> </span><a name="local-6989586621679044857"><a href="#local-6989586621679044857"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">BS.length</span><span> </span><a href="#local-6989586621679044857"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_seedbytes"><span class="hs-identifier hs-var">crypto_vrf_seedbytes</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-219"></a><span>  </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Not enough bytes for seed&quot;</span><span>
</span><a name="line-220"></a><span class="hs-identifier">seedFromBytes</span><span> </span><a name="local-6989586621679044858"><a href="#local-6989586621679044858"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-221"></a><span>  </span><a name="local-6989586621679044878"><a href="#local-6989586621679044878"><span class="hs-identifier">seed</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#mkSeed"><span class="hs-identifier hs-var">mkSeed</span></a><span>
</span><a name="line-222"></a><span>  </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unSeed</span><span> </span><a href="#local-6989586621679044878"><span class="hs-identifier hs-var">seed</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044879"><a href="#local-6989586621679044879"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-223"></a><span>    </span><a href="Cardano.Crypto.VRF.Praos.html#copyFromByteString"><span class="hs-identifier hs-var">copyFromByteString</span></a><span> </span><a href="#local-6989586621679044879"><span class="hs-identifier hs-var">ptr</span></a><span> </span><a href="#local-6989586621679044858"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_seedbytes"><span class="hs-identifier hs-var">crypto_vrf_seedbytes</span></a><span class="hs-special">)</span><span>
</span><a name="line-224"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679044878"><span class="hs-identifier hs-var">seed</span></a><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-comment">-- | Convert an opaque 'Seed' into a 'ByteString' that we can inspect.</span><span>
</span><a name="line-227"></a><span class="hs-comment">-- Note that this will copy the seed into RTS-managed memory; this is not</span><span>
</span><a name="line-228"></a><span class="hs-comment">-- currently a problem, but if at any point we decide that we want to make</span><span>
</span><a name="line-229"></a><span class="hs-comment">-- sure the seed is properly mlocked, then this function will leak such a</span><span>
</span><a name="line-230"></a><span class="hs-comment">-- secured seed into non-locked (swappable) memory.</span><span>
</span><a name="line-231"></a><span class="hs-identifier">unsafeRawSeed</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Seed"><span class="hs-identifier hs-type">Seed</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-232"></a><a name="unsafeRawSeed"><a href="Cardano.Crypto.VRF.Praos.html#unsafeRawSeed"><span class="hs-identifier">unsafeRawSeed</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Crypto.VRF.Praos.html#Seed"><span class="hs-identifier hs-var">Seed</span></a><span> </span><a name="local-6989586621679044880"><a href="#local-6989586621679044880"><span class="hs-identifier">fp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><a href="#local-6989586621679044880"><span class="hs-identifier hs-var">fp</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044881"><a href="#local-6989586621679044881"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-233"></a><span>  </span><span class="hs-identifier hs-var">BS.packCStringLen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">castPtr</span><span> </span><a href="#local-6989586621679044881"><span class="hs-identifier hs-var">ptr</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_seedbytes"><span class="hs-identifier hs-var">crypto_vrf_seedbytes</span></a><span class="hs-special">)</span><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-comment">-- | Convert a proof verification output hash into a 'ByteString' that we can</span><span>
</span><a name="line-236"></a><span class="hs-comment">-- inspect.</span><span>
</span><a name="line-237"></a><span class="hs-identifier">outputBytes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Output"><span class="hs-identifier hs-type">Output</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-238"></a><a name="outputBytes"><a href="Cardano.Crypto.VRF.Praos.html#outputBytes"><span class="hs-identifier">outputBytes</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Crypto.VRF.Praos.html#Output"><span class="hs-identifier hs-var">Output</span></a><span> </span><a name="local-6989586621679044882"><a href="#local-6989586621679044882"><span class="hs-identifier">op</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><a href="#local-6989586621679044882"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044883"><a href="#local-6989586621679044883"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-239"></a><span>  </span><span class="hs-identifier hs-var">BS.packCStringLen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">castPtr</span><span> </span><a href="#local-6989586621679044883"><span class="hs-identifier hs-var">ptr</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_outputbytes"><span class="hs-identifier hs-var">crypto_vrf_outputbytes</span></a><span class="hs-special">)</span><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span class="hs-comment">-- | Convert a proof into a 'ByteString' that we can inspect.</span><span>
</span><a name="line-242"></a><span class="hs-identifier">proofBytes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Proof"><span class="hs-identifier hs-type">Proof</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-243"></a><a name="proofBytes"><a href="Cardano.Crypto.VRF.Praos.html#proofBytes"><span class="hs-identifier">proofBytes</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Crypto.VRF.Praos.html#Proof"><span class="hs-identifier hs-var">Proof</span></a><span> </span><a name="local-6989586621679044884"><a href="#local-6989586621679044884"><span class="hs-identifier">op</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><a href="#local-6989586621679044884"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044885"><a href="#local-6989586621679044885"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-244"></a><span>  </span><span class="hs-identifier hs-var">BS.packCStringLen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">castPtr</span><span> </span><a href="#local-6989586621679044885"><span class="hs-identifier hs-var">ptr</span></a><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#certSizeVRF"><span class="hs-identifier hs-var">certSizeVRF</span></a><span class="hs-special">)</span><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span class="hs-comment">-- | Convert a verification key into a 'ByteString' that we can inspect.</span><span>
</span><a name="line-247"></a><span class="hs-identifier">vkBytes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKey"><span class="hs-identifier hs-type">VerKey</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-248"></a><a name="vkBytes"><a href="Cardano.Crypto.VRF.Praos.html#vkBytes"><span class="hs-identifier">vkBytes</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Crypto.VRF.Praos.html#VerKey"><span class="hs-identifier hs-var">VerKey</span></a><span> </span><a name="local-6989586621679044886"><a href="#local-6989586621679044886"><span class="hs-identifier">op</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><a href="#local-6989586621679044886"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044887"><a href="#local-6989586621679044887"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-249"></a><span>  </span><span class="hs-identifier hs-var">BS.packCStringLen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">castPtr</span><span> </span><a href="#local-6989586621679044887"><span class="hs-identifier hs-var">ptr</span></a><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#verKeySizeVRF"><span class="hs-identifier hs-var">verKeySizeVRF</span></a><span class="hs-special">)</span><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span class="hs-comment">-- | Convert a signing key into a 'ByteString' that we can inspect.</span><span>
</span><a name="line-252"></a><span class="hs-identifier">skBytes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKey"><span class="hs-identifier hs-type">SignKey</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-253"></a><a name="skBytes"><a href="Cardano.Crypto.VRF.Praos.html#skBytes"><span class="hs-identifier">skBytes</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Crypto.VRF.Praos.html#SignKey"><span class="hs-identifier hs-var">SignKey</span></a><span> </span><a name="local-6989586621679044888"><a href="#local-6989586621679044888"><span class="hs-identifier">op</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><a href="#local-6989586621679044888"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044889"><a href="#local-6989586621679044889"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-254"></a><span>  </span><span class="hs-identifier hs-var">BS.packCStringLen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">castPtr</span><span> </span><a href="#local-6989586621679044889"><span class="hs-identifier hs-var">ptr</span></a><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#signKeySizeVRF"><span class="hs-identifier hs-var">signKeySizeVRF</span></a><span class="hs-special">)</span><span>
</span><a name="line-255"></a><span>
</span><a name="line-256"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Proof"><span class="hs-identifier hs-type">Proof</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-257"></a><span>  </span><a name="local-8214565720323790323"><span class="hs-identifier">show</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#proofBytes"><span class="hs-identifier hs-var">proofBytes</span></a><span>
</span><a name="line-258"></a><span>
</span><a name="line-259"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Proof"><span class="hs-identifier hs-type">Proof</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-260"></a><span>  </span><a name="local-6989586621679042924"><a href="#local-6989586621679042924"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a name="local-6989586621679042925"><a href="#local-6989586621679042925"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#proofBytes"><span class="hs-identifier hs-var">proofBytes</span></a><span> </span><a href="#local-6989586621679042924"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#proofBytes"><span class="hs-identifier hs-var">proofBytes</span></a><span> </span><a href="#local-6989586621679042925"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#ToCBOR"><span class="hs-identifier hs-type">ToCBOR</span></a><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Proof"><span class="hs-identifier hs-type">Proof</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-263"></a><span>  </span><a name="local-8214565720323791715"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#toCBOR"><span class="hs-identifier">toCBOR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#toCBOR"><span class="hs-identifier hs-var">toCBOR</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#proofBytes"><span class="hs-identifier hs-var">proofBytes</span></a><span>
</span><a name="line-264"></a><span>  </span><a name="local-8214565720323791714"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#encodedSizeExpr"><span class="hs-identifier">encodedSizeExpr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-265"></a><span>    </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#encodedSizeExpr"><span class="hs-identifier hs-var">encodedSizeExpr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#certSizeVRF"><span class="hs-identifier hs-var">certSizeVRF</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">)</span><span>
</span><a name="line-266"></a><span>
</span><a name="line-267"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.FromCBOR.html#FromCBOR"><span class="hs-identifier hs-type">FromCBOR</span></a><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Proof"><span class="hs-identifier hs-type">Proof</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-268"></a><span>  </span><a name="local-8214565720323791782"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.FromCBOR.html#fromCBOR"><span class="hs-identifier">fromCBOR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#proofFromBytes"><span class="hs-identifier hs-var">proofFromBytes</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.FromCBOR.html#fromCBOR"><span class="hs-identifier hs-var">fromCBOR</span></a><span>
</span><a name="line-269"></a><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKey"><span class="hs-identifier hs-type">SignKey</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-272"></a><span>  </span><a name="local-8214565720323790323"><span class="hs-identifier">show</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#skBytes"><span class="hs-identifier hs-var">skBytes</span></a><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKey"><span class="hs-identifier hs-type">SignKey</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-275"></a><span>  </span><a name="local-6989586621679042922"><a href="#local-6989586621679042922"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a name="local-6989586621679042923"><a href="#local-6989586621679042923"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#skBytes"><span class="hs-identifier hs-var">skBytes</span></a><span> </span><a href="#local-6989586621679042922"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#skBytes"><span class="hs-identifier hs-var">skBytes</span></a><span> </span><a href="#local-6989586621679042923"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-276"></a><span>
</span><a name="line-277"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#ToCBOR"><span class="hs-identifier hs-type">ToCBOR</span></a><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKey"><span class="hs-identifier hs-type">SignKey</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-278"></a><span>  </span><a name="local-8214565720323791715"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#toCBOR"><span class="hs-identifier">toCBOR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#toCBOR"><span class="hs-identifier hs-var">toCBOR</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#skBytes"><span class="hs-identifier hs-var">skBytes</span></a><span>
</span><a name="line-279"></a><span>  </span><a name="local-8214565720323791714"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#encodedSizeExpr"><span class="hs-identifier">encodedSizeExpr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-280"></a><span>    </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#encodedSizeExpr"><span class="hs-identifier hs-var">encodedSizeExpr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#signKeySizeVRF"><span class="hs-identifier hs-var">signKeySizeVRF</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">)</span><span>
</span><a name="line-281"></a><span>
</span><a name="line-282"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.FromCBOR.html#FromCBOR"><span class="hs-identifier hs-type">FromCBOR</span></a><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKey"><span class="hs-identifier hs-type">SignKey</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-283"></a><span>  </span><a name="local-8214565720323791782"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.FromCBOR.html#fromCBOR"><span class="hs-identifier">fromCBOR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#skFromBytes"><span class="hs-identifier hs-var">skFromBytes</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.FromCBOR.html#fromCBOR"><span class="hs-identifier hs-var">fromCBOR</span></a><span>
</span><a name="line-284"></a><span>
</span><a name="line-285"></a><span>
</span><a name="line-286"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKey"><span class="hs-identifier hs-type">VerKey</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-287"></a><span>  </span><a name="local-8214565720323790323"><span class="hs-identifier">show</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#vkBytes"><span class="hs-identifier hs-var">vkBytes</span></a><span>
</span><a name="line-288"></a><span>
</span><a name="line-289"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKey"><span class="hs-identifier hs-type">VerKey</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-290"></a><span>  </span><a name="local-6989586621679042920"><a href="#local-6989586621679042920"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a name="local-6989586621679042921"><a href="#local-6989586621679042921"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#vkBytes"><span class="hs-identifier hs-var">vkBytes</span></a><span> </span><a href="#local-6989586621679042920"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#vkBytes"><span class="hs-identifier hs-var">vkBytes</span></a><span> </span><a href="#local-6989586621679042921"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-291"></a><span>
</span><a name="line-292"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#ToCBOR"><span class="hs-identifier hs-type">ToCBOR</span></a><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKey"><span class="hs-identifier hs-type">VerKey</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-293"></a><span>  </span><a name="local-8214565720323791715"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#toCBOR"><span class="hs-identifier">toCBOR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#toCBOR"><span class="hs-identifier hs-var">toCBOR</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#vkBytes"><span class="hs-identifier hs-var">vkBytes</span></a><span>
</span><a name="line-294"></a><span>  </span><a name="local-8214565720323791714"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#encodedSizeExpr"><span class="hs-identifier">encodedSizeExpr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-295"></a><span>    </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#encodedSizeExpr"><span class="hs-identifier hs-var">encodedSizeExpr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#verKeySizeVRF"><span class="hs-identifier hs-var">verKeySizeVRF</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">)</span><span>
</span><a name="line-296"></a><span>
</span><a name="line-297"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.FromCBOR.html#FromCBOR"><span class="hs-identifier hs-type">FromCBOR</span></a><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKey"><span class="hs-identifier hs-type">VerKey</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-298"></a><span>  </span><a name="local-8214565720323791782"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.FromCBOR.html#fromCBOR"><span class="hs-identifier">fromCBOR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#vkFromBytes"><span class="hs-identifier hs-var">vkFromBytes</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.FromCBOR.html#fromCBOR"><span class="hs-identifier hs-var">fromCBOR</span></a><span>
</span><a name="line-299"></a><span>
</span><a name="line-300"></a><span class="hs-comment">-- | Allocate a Verification Key and attach a finalizer. The allocated memory will</span><span>
</span><a name="line-301"></a><span class="hs-comment">-- not be initialized.</span><span>
</span><a name="line-302"></a><span class="hs-identifier">mkVerKey</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKey"><span class="hs-identifier hs-type">VerKey</span></a><span>
</span><a name="line-303"></a><a name="mkVerKey"><a href="Cardano.Crypto.VRF.Praos.html#mkVerKey"><span class="hs-identifier">mkVerKey</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKey"><span class="hs-identifier hs-var">VerKey</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">newForeignPtr</span><span> </span><span class="hs-identifier hs-var">finalizerFree</span><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><span class="hs-identifier hs-var">mallocBytes</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#verKeySizeVRF"><span class="hs-identifier hs-var">verKeySizeVRF</span></a><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span class="hs-comment">-- | Allocate a Signing Key and attach a finalizer. The allocated memory will</span><span>
</span><a name="line-306"></a><span class="hs-comment">-- not be initialized.</span><span>
</span><a name="line-307"></a><span class="hs-identifier">mkSignKey</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKey"><span class="hs-identifier hs-type">SignKey</span></a><span>
</span><a name="line-308"></a><a name="mkSignKey"><a href="Cardano.Crypto.VRF.Praos.html#mkSignKey"><span class="hs-identifier">mkSignKey</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKey"><span class="hs-identifier hs-var">SignKey</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">newForeignPtr</span><span> </span><span class="hs-identifier hs-var">finalizerFree</span><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><span class="hs-identifier hs-var">mallocBytes</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#signKeySizeVRF"><span class="hs-identifier hs-var">signKeySizeVRF</span></a><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span class="hs-comment">-- | Allocate a Proof and attach a finalizer. The allocated memory will</span><span>
</span><a name="line-311"></a><span class="hs-comment">-- not be initialized.</span><span>
</span><a name="line-312"></a><span class="hs-identifier">mkProof</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Proof"><span class="hs-identifier hs-type">Proof</span></a><span>
</span><a name="line-313"></a><a name="mkProof"><a href="Cardano.Crypto.VRF.Praos.html#mkProof"><span class="hs-identifier">mkProof</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Proof"><span class="hs-identifier hs-var">Proof</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">newForeignPtr</span><span> </span><span class="hs-identifier hs-var">finalizerFree</span><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><span class="hs-identifier hs-var">mallocBytes</span><span> </span><span class="hs-special">(</span><a href="Cardano.Crypto.VRF.Praos.html#certSizeVRF"><span class="hs-identifier hs-var">certSizeVRF</span></a><span class="hs-special">)</span><span>
</span><a name="line-314"></a><span>
</span><a name="line-315"></a><span class="hs-identifier">proofFromBytes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Proof"><span class="hs-identifier hs-type">Proof</span></a><span>
</span><a name="line-316"></a><a name="proofFromBytes"><a href="Cardano.Crypto.VRF.Praos.html#proofFromBytes"><span class="hs-identifier">proofFromBytes</span></a></a><span> </span><a name="local-6989586621679044890"><a href="#local-6989586621679044890"><span class="hs-identifier">bs</span></a></a><span>
</span><a name="line-317"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">BS.length</span><span> </span><a href="#local-6989586621679044890"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#certSizeVRF"><span class="hs-identifier hs-var">certSizeVRF</span></a><span>
</span><a name="line-318"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Invalid proof length&quot;</span><span>
</span><a name="line-319"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-320"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-321"></a><span>      </span><a name="local-6989586621679044891"><a href="#local-6989586621679044891"><span class="hs-identifier">proof</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#mkProof"><span class="hs-identifier hs-var">mkProof</span></a><span>
</span><a name="line-322"></a><span>      </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unProof</span><span> </span><a href="#local-6989586621679044891"><span class="hs-identifier hs-var">proof</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044892"><a href="#local-6989586621679044892"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-323"></a><span>        </span><a href="Cardano.Crypto.VRF.Praos.html#copyFromByteString"><span class="hs-identifier hs-var">copyFromByteString</span></a><span> </span><a href="#local-6989586621679044892"><span class="hs-identifier hs-var">ptr</span></a><span> </span><a href="#local-6989586621679044890"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="Cardano.Crypto.VRF.Praos.html#certSizeVRF"><span class="hs-identifier hs-var">certSizeVRF</span></a><span>
</span><a name="line-324"></a><span>      </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679044891"><span class="hs-identifier hs-var">proof</span></a><span>
</span><a name="line-325"></a><span>
</span><a name="line-326"></a><span class="hs-identifier">skFromBytes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKey"><span class="hs-identifier hs-type">SignKey</span></a><span>
</span><a name="line-327"></a><a name="skFromBytes"><a href="Cardano.Crypto.VRF.Praos.html#skFromBytes"><span class="hs-identifier">skFromBytes</span></a></a><span> </span><a name="local-6989586621679044893"><a href="#local-6989586621679044893"><span class="hs-identifier">bs</span></a></a><span>
</span><a name="line-328"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">BS.length</span><span> </span><a href="#local-6989586621679044893"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#signKeySizeVRF"><span class="hs-identifier hs-var">signKeySizeVRF</span></a><span>
</span><a name="line-329"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Invalid sk length&quot;</span><span>
</span><a name="line-330"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-331"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-332"></a><span>      </span><a name="local-6989586621679044894"><a href="#local-6989586621679044894"><span class="hs-identifier">sk</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#mkSignKey"><span class="hs-identifier hs-var">mkSignKey</span></a><span>
</span><a name="line-333"></a><span>      </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unSignKey</span><span> </span><a href="#local-6989586621679044894"><span class="hs-identifier hs-var">sk</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044895"><a href="#local-6989586621679044895"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-334"></a><span>        </span><a href="Cardano.Crypto.VRF.Praos.html#copyFromByteString"><span class="hs-identifier hs-var">copyFromByteString</span></a><span> </span><a href="#local-6989586621679044895"><span class="hs-identifier hs-var">ptr</span></a><span> </span><a href="#local-6989586621679044893"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="Cardano.Crypto.VRF.Praos.html#signKeySizeVRF"><span class="hs-identifier hs-var">signKeySizeVRF</span></a><span>
</span><a name="line-335"></a><span>      </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679044894"><span class="hs-identifier hs-var">sk</span></a><span>
</span><a name="line-336"></a><span>
</span><a name="line-337"></a><span class="hs-identifier">vkFromBytes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKey"><span class="hs-identifier hs-type">VerKey</span></a><span>
</span><a name="line-338"></a><a name="vkFromBytes"><a href="Cardano.Crypto.VRF.Praos.html#vkFromBytes"><span class="hs-identifier">vkFromBytes</span></a></a><span> </span><a name="local-6989586621679044896"><a href="#local-6989586621679044896"><span class="hs-identifier">bs</span></a></a><span>
</span><a name="line-339"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">BS.length</span><span> </span><a href="#local-6989586621679044896"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#verKeySizeVRF"><span class="hs-identifier hs-var">verKeySizeVRF</span></a><span>
</span><a name="line-340"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Invalid pk length&quot;</span><span>
</span><a name="line-341"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-342"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-343"></a><span>      </span><a name="local-6989586621679044897"><a href="#local-6989586621679044897"><span class="hs-identifier">pk</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#mkVerKey"><span class="hs-identifier hs-var">mkVerKey</span></a><span>
</span><a name="line-344"></a><span>      </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unVerKey</span><span> </span><a href="#local-6989586621679044897"><span class="hs-identifier hs-var">pk</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044898"><a href="#local-6989586621679044898"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-345"></a><span>        </span><a href="Cardano.Crypto.VRF.Praos.html#copyFromByteString"><span class="hs-identifier hs-var">copyFromByteString</span></a><span> </span><a href="#local-6989586621679044898"><span class="hs-identifier hs-var">ptr</span></a><span> </span><a href="#local-6989586621679044896"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="Cardano.Crypto.VRF.Praos.html#verKeySizeVRF"><span class="hs-identifier hs-var">verKeySizeVRF</span></a><span>
</span><a name="line-346"></a><span>      </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679044897"><span class="hs-identifier hs-var">pk</span></a><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span class="hs-comment">-- | Allocate an Output and attach a finalizer. The allocated memory will</span><span>
</span><a name="line-349"></a><span class="hs-comment">-- not be initialized.</span><span>
</span><a name="line-350"></a><span class="hs-identifier">mkOutput</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Output"><span class="hs-identifier hs-type">Output</span></a><span>
</span><a name="line-351"></a><a name="mkOutput"><a href="Cardano.Crypto.VRF.Praos.html#mkOutput"><span class="hs-identifier">mkOutput</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Output"><span class="hs-identifier hs-var">Output</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">newForeignPtr</span><span> </span><span class="hs-identifier hs-var">finalizerFree</span><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><span class="hs-identifier hs-var">mallocBytes</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_outputbytes"><span class="hs-identifier hs-var">crypto_vrf_outputbytes</span></a><span class="hs-special">)</span><span>
</span><a name="line-352"></a><span>
</span><a name="line-353"></a><span class="hs-comment">-- | Derive a key pair (Sign + Verify) from a seed.</span><span>
</span><a name="line-354"></a><span class="hs-identifier">keypairFromSeed</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Seed"><span class="hs-identifier hs-type">Seed</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Cardano.Crypto.VRF.Praos.html#VerKey"><span class="hs-identifier hs-type">VerKey</span></a><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKey"><span class="hs-identifier hs-type">SignKey</span></a><span class="hs-special">)</span><span>
</span><a name="line-355"></a><a name="keypairFromSeed"><a href="Cardano.Crypto.VRF.Praos.html#keypairFromSeed"><span class="hs-identifier">keypairFromSeed</span></a></a><span> </span><a name="local-6989586621679044899"><a href="#local-6989586621679044899"><span class="hs-identifier">seed</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-356"></a><span>  </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unSeed</span><span> </span><a href="#local-6989586621679044899"><span class="hs-identifier hs-var">seed</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044900"><a href="#local-6989586621679044900"><span class="hs-identifier">sptr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-357"></a><span>    </span><a name="local-6989586621679044901"><a href="#local-6989586621679044901"><span class="hs-identifier">pk</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#mkVerKey"><span class="hs-identifier hs-var">mkVerKey</span></a><span>
</span><a name="line-358"></a><span>    </span><a name="local-6989586621679044902"><a href="#local-6989586621679044902"><span class="hs-identifier">sk</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#mkSignKey"><span class="hs-identifier hs-var">mkSignKey</span></a><span>
</span><a name="line-359"></a><span>    </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unVerKey</span><span> </span><a href="#local-6989586621679044901"><span class="hs-identifier hs-var">pk</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044903"><a href="#local-6989586621679044903"><span class="hs-identifier">pkPtr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-360"></a><span>      </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unSignKey</span><span> </span><a href="#local-6989586621679044902"><span class="hs-identifier hs-var">sk</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044904"><a href="#local-6989586621679044904"><span class="hs-identifier">skPtr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-361"></a><span>        </span><span class="hs-identifier hs-var">void</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_keypair_from_seed"><span class="hs-identifier hs-var">crypto_vrf_keypair_from_seed</span></a><span> </span><a href="#local-6989586621679044903"><span class="hs-identifier hs-var">pkPtr</span></a><span> </span><a href="#local-6989586621679044904"><span class="hs-identifier hs-var">skPtr</span></a><span> </span><a href="#local-6989586621679044900"><span class="hs-identifier hs-var">sptr</span></a><span>
</span><a name="line-362"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679044901"><span class="hs-identifier hs-var">pk</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679044902"><span class="hs-identifier hs-var">sk</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679044901"><span class="hs-identifier hs-var">pk</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679044902"><span class="hs-identifier hs-var">sk</span></a><span class="hs-special">)</span><span>
</span><a name="line-363"></a><span>
</span><a name="line-364"></a><span class="hs-comment">-- | Derive a Verification Key from a Signing Key.</span><span>
</span><a name="line-365"></a><span class="hs-identifier">skToVerKey</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKey"><span class="hs-identifier hs-type">SignKey</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKey"><span class="hs-identifier hs-type">VerKey</span></a><span>
</span><a name="line-366"></a><a name="skToVerKey"><a href="Cardano.Crypto.VRF.Praos.html#skToVerKey"><span class="hs-identifier">skToVerKey</span></a></a><span> </span><a name="local-6989586621679044905"><a href="#local-6989586621679044905"><span class="hs-identifier">sk</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-367"></a><span>  </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unSignKey</span><span> </span><a href="#local-6989586621679044905"><span class="hs-identifier hs-var">sk</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044906"><a href="#local-6989586621679044906"><span class="hs-identifier">skPtr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-368"></a><span>    </span><a name="local-6989586621679044907"><a href="#local-6989586621679044907"><span class="hs-identifier">pk</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#mkVerKey"><span class="hs-identifier hs-var">mkVerKey</span></a><span>
</span><a name="line-369"></a><span>    </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unVerKey</span><span> </span><a href="#local-6989586621679044907"><span class="hs-identifier hs-var">pk</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044908"><a href="#local-6989586621679044908"><span class="hs-identifier">pkPtr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-370"></a><span>      </span><span class="hs-identifier hs-var">void</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_sk_to_pk"><span class="hs-identifier hs-var">crypto_vrf_sk_to_pk</span></a><span> </span><a href="#local-6989586621679044908"><span class="hs-identifier hs-var">pkPtr</span></a><span> </span><a href="#local-6989586621679044906"><span class="hs-identifier hs-var">skPtr</span></a><span>
</span><a name="line-371"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679044907"><span class="hs-identifier hs-var">pk</span></a><span>
</span><a name="line-372"></a><span>
</span><a name="line-373"></a><span class="hs-comment">-- | Get the seed used to generate a given Signing Key</span><span>
</span><a name="line-374"></a><span class="hs-identifier">skToSeed</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKey"><span class="hs-identifier hs-type">SignKey</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Seed"><span class="hs-identifier hs-type">Seed</span></a><span>
</span><a name="line-375"></a><a name="skToSeed"><a href="Cardano.Crypto.VRF.Praos.html#skToSeed"><span class="hs-identifier">skToSeed</span></a></a><span> </span><a name="local-6989586621679044909"><a href="#local-6989586621679044909"><span class="hs-identifier">sk</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-376"></a><span>  </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unSignKey</span><span> </span><a href="#local-6989586621679044909"><span class="hs-identifier hs-var">sk</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044910"><a href="#local-6989586621679044910"><span class="hs-identifier">skPtr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-377"></a><span>    </span><a name="local-6989586621679044911"><a href="#local-6989586621679044911"><span class="hs-identifier">seed</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#mkSeed"><span class="hs-identifier hs-var">mkSeed</span></a><span>
</span><a name="line-378"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unSeed</span><span> </span><a href="#local-6989586621679044911"><span class="hs-identifier hs-var">seed</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044912"><a href="#local-6989586621679044912"><span class="hs-identifier">seedPtr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-379"></a><span>      </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_sk_to_seed"><span class="hs-identifier hs-var">crypto_vrf_sk_to_seed</span></a><span> </span><a href="#local-6989586621679044912"><span class="hs-identifier hs-var">seedPtr</span></a><span> </span><a href="#local-6989586621679044910"><span class="hs-identifier hs-var">skPtr</span></a><span>
</span><a name="line-380"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679044911"><span class="hs-identifier hs-var">seed</span></a><span>
</span><a name="line-381"></a><span>
</span><a name="line-382"></a><span class="hs-comment">-- | Construct a proof from a Signing Key and a message.</span><span>
</span><a name="line-383"></a><span class="hs-comment">-- Returns 'Just' the proof on success, 'Nothing' if the signing key could not</span><span>
</span><a name="line-384"></a><span class="hs-comment">-- be decoded.</span><span>
</span><a name="line-385"></a><span class="hs-identifier">prove</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKey"><span class="hs-identifier hs-type">SignKey</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Proof"><span class="hs-identifier hs-type">Proof</span></a><span>
</span><a name="line-386"></a><a name="prove"><a href="Cardano.Crypto.VRF.Praos.html#prove"><span class="hs-identifier">prove</span></a></a><span> </span><a name="local-6989586621679044913"><a href="#local-6989586621679044913"><span class="hs-identifier">sk</span></a></a><span> </span><a name="local-6989586621679044914"><a href="#local-6989586621679044914"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-387"></a><span>  </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-388"></a><span>    </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unSignKey</span><span> </span><a href="#local-6989586621679044913"><span class="hs-identifier hs-var">sk</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044915"><a href="#local-6989586621679044915"><span class="hs-identifier">skPtr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-389"></a><span>      </span><a name="local-6989586621679044916"><a href="#local-6989586621679044916"><span class="hs-identifier">proof</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#mkProof"><span class="hs-identifier hs-var">mkProof</span></a><span>
</span><a name="line-390"></a><span>      </span><span class="hs-identifier hs-var">BS.useAsCStringLen</span><span> </span><a href="#local-6989586621679044914"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679044917"><a href="#local-6989586621679044917"><span class="hs-identifier">m</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679044918"><a href="#local-6989586621679044918"><span class="hs-identifier">mlen</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-391"></a><span>        </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unProof</span><span> </span><a href="#local-6989586621679044916"><span class="hs-identifier hs-var">proof</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044919"><a href="#local-6989586621679044919"><span class="hs-identifier">proofPtr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-392"></a><span>          </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_prove"><span class="hs-identifier hs-var">crypto_vrf_prove</span></a><span> </span><a href="#local-6989586621679044919"><span class="hs-identifier hs-var">proofPtr</span></a><span> </span><a href="#local-6989586621679044915"><span class="hs-identifier hs-var">skPtr</span></a><span> </span><a href="#local-6989586621679044917"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679044918"><span class="hs-identifier hs-var">mlen</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-393"></a><span>            </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679044916"><span class="hs-identifier hs-var">proof</span></a><span>
</span><a name="line-394"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-395"></a><span>
</span><a name="line-396"></a><span class="hs-comment">-- | Verify a VRF proof and validate the Verification Key. Returns 'Just' a hash of</span><span>
</span><a name="line-397"></a><span class="hs-comment">-- the verification result on success, 'Nothing' if the verification did not</span><span>
</span><a name="line-398"></a><span class="hs-comment">-- succeed.</span><span>
</span><a name="line-399"></a><span class="hs-comment">--</span><span>
</span><a name="line-400"></a><span class="hs-comment">-- For a given verification key and message, there are many possible proofs but only</span><span>
</span><a name="line-401"></a><span class="hs-comment">-- one possible output hash.</span><span>
</span><a name="line-402"></a><span class="hs-identifier">verify</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKey"><span class="hs-identifier hs-type">VerKey</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Proof"><span class="hs-identifier hs-type">Proof</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Output"><span class="hs-identifier hs-type">Output</span></a><span>
</span><a name="line-403"></a><a name="verify"><a href="Cardano.Crypto.VRF.Praos.html#verify"><span class="hs-identifier">verify</span></a></a><span> </span><a name="local-6989586621679044920"><a href="#local-6989586621679044920"><span class="hs-identifier">pk</span></a></a><span> </span><a name="local-6989586621679044921"><a href="#local-6989586621679044921"><span class="hs-identifier">proof</span></a></a><span> </span><a name="local-6989586621679044922"><a href="#local-6989586621679044922"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-404"></a><span>  </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-405"></a><span>    </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unVerKey</span><span> </span><a href="#local-6989586621679044920"><span class="hs-identifier hs-var">pk</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044923"><a href="#local-6989586621679044923"><span class="hs-identifier">pkPtr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-406"></a><span>      </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unProof</span><span> </span><a href="#local-6989586621679044921"><span class="hs-identifier hs-var">proof</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044924"><a href="#local-6989586621679044924"><span class="hs-identifier">proofPtr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-407"></a><span>        </span><a name="local-6989586621679044925"><a href="#local-6989586621679044925"><span class="hs-identifier">output</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#mkOutput"><span class="hs-identifier hs-var">mkOutput</span></a><span>
</span><a name="line-408"></a><span>        </span><span class="hs-identifier hs-var">BS.useAsCStringLen</span><span> </span><a href="#local-6989586621679044922"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679044926"><a href="#local-6989586621679044926"><span class="hs-identifier">m</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679044927"><a href="#local-6989586621679044927"><span class="hs-identifier">mlen</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-409"></a><span>          </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unOutput</span><span> </span><a href="#local-6989586621679044925"><span class="hs-identifier hs-var">output</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044928"><a href="#local-6989586621679044928"><span class="hs-identifier">outputPtr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-410"></a><span>            </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_verify"><span class="hs-identifier hs-var">crypto_vrf_verify</span></a><span> </span><a href="#local-6989586621679044928"><span class="hs-identifier hs-var">outputPtr</span></a><span> </span><a href="#local-6989586621679044923"><span class="hs-identifier hs-var">pkPtr</span></a><span> </span><a href="#local-6989586621679044924"><span class="hs-identifier hs-var">proofPtr</span></a><span> </span><a href="#local-6989586621679044926"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679044927"><span class="hs-identifier hs-var">mlen</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-411"></a><span>              </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679044925"><span class="hs-identifier hs-var">output</span></a><span>
</span><a name="line-412"></a><span>              </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-413"></a><span>
</span><a name="line-414"></a><span class="hs-identifier">outputFromProof</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Proof"><span class="hs-identifier hs-type">Proof</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Output"><span class="hs-identifier hs-type">Output</span></a><span>
</span><a name="line-415"></a><a name="outputFromProof"><a href="Cardano.Crypto.VRF.Praos.html#outputFromProof"><span class="hs-identifier">outputFromProof</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Crypto.VRF.Praos.html#Proof"><span class="hs-identifier hs-var">Proof</span></a><span> </span><a name="local-6989586621679044929"><a href="#local-6989586621679044929"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-416"></a><span>  </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-417"></a><span>    </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><a href="#local-6989586621679044929"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044930"><a href="#local-6989586621679044930"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-418"></a><span>      </span><a name="local-6989586621679044931"><a href="#local-6989586621679044931"><span class="hs-identifier">output</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#mkOutput"><span class="hs-identifier hs-var">mkOutput</span></a><span>
</span><a name="line-419"></a><span>      </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unOutput</span><span> </span><a href="#local-6989586621679044931"><span class="hs-identifier hs-var">output</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044932"><a href="#local-6989586621679044932"><span class="hs-identifier">outputPtr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-420"></a><span>        </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_proof_to_hash"><span class="hs-identifier hs-var">crypto_vrf_proof_to_hash</span></a><span> </span><a href="#local-6989586621679044932"><span class="hs-identifier hs-var">outputPtr</span></a><span> </span><a href="#local-6989586621679044930"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-421"></a><span>          </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679044931"><span class="hs-identifier hs-var">output</span></a><span>
</span><a name="line-422"></a><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-423"></a><span>
</span><a name="line-424"></a><span class="hs-keyword">data</span><span> </span><a name="PraosVRF"><a href="Cardano.Crypto.VRF.Praos.html#PraosVRF"><span class="hs-identifier">PraosVRF</span></a></a><span>
</span><a name="line-425"></a><span>
</span><a name="line-426"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#VRFAlgorithm"><span class="hs-identifier hs-type">VRFAlgorithm</span></a><span> </span><a href="Cardano.Crypto.VRF.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-427"></a><span>  </span><span class="hs-keyword">newtype</span><span> </span><span class="hs-identifier">VerKeyVRF</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="VerKeyPraosVRF"><a href="Cardano.Crypto.VRF.Praos.html#VerKeyPraosVRF"><span class="hs-identifier">VerKeyPraosVRF</span></a></a><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKey"><span class="hs-identifier hs-type">VerKey</span></a><span>
</span><a name="line-428"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-429"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">newtype</span><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#ToCBOR"><span class="hs-identifier hs-type">ToCBOR</span></a><span class="hs-special">,</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.FromCBOR.html#FromCBOR"><span class="hs-identifier hs-type">FromCBOR</span></a><span class="hs-special">)</span><span>
</span><a name="line-430"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#NoUnexpectedThunks"><span class="hs-identifier hs-type">NoUnexpectedThunks</span></a><span> </span><span class="hs-keyword">via</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#OnlyCheckIsWHNF"><span class="hs-identifier hs-type">OnlyCheckIsWHNF</span></a><span> </span><span class="hs-string">&quot;VerKeyVRF&quot;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKey"><span class="hs-identifier hs-type">VerKey</span></a><span>
</span><a name="line-431"></a><span>
</span><a name="line-432"></a><span>  </span><span class="hs-keyword">newtype</span><span> </span><span class="hs-identifier">SignKeyVRF</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SignKeyPraosVRF"><a href="Cardano.Crypto.VRF.Praos.html#SignKeyPraosVRF"><span class="hs-identifier">SignKeyPraosVRF</span></a></a><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKey"><span class="hs-identifier hs-type">SignKey</span></a><span>
</span><a name="line-433"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-434"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">newtype</span><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#ToCBOR"><span class="hs-identifier hs-type">ToCBOR</span></a><span class="hs-special">,</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.FromCBOR.html#FromCBOR"><span class="hs-identifier hs-type">FromCBOR</span></a><span class="hs-special">)</span><span>
</span><a name="line-435"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#NoUnexpectedThunks"><span class="hs-identifier hs-type">NoUnexpectedThunks</span></a><span> </span><span class="hs-keyword">via</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#OnlyCheckIsWHNF"><span class="hs-identifier hs-type">OnlyCheckIsWHNF</span></a><span> </span><span class="hs-string">&quot;SignKeyVRF&quot;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#SignKey"><span class="hs-identifier hs-type">SignKey</span></a><span>
</span><a name="line-436"></a><span>
</span><a name="line-437"></a><span>  </span><span class="hs-keyword">newtype</span><span> </span><span class="hs-identifier">CertVRF</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="CertPraosVRF"><a href="Cardano.Crypto.VRF.Praos.html#CertPraosVRF"><span class="hs-identifier">CertPraosVRF</span></a></a><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Proof"><span class="hs-identifier hs-type">Proof</span></a><span>
</span><a name="line-438"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-439"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">newtype</span><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.ToCBOR.html#ToCBOR"><span class="hs-identifier hs-type">ToCBOR</span></a><span class="hs-special">,</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src/Cardano.Binary.FromCBOR.html#FromCBOR"><span class="hs-identifier hs-type">FromCBOR</span></a><span class="hs-special">)</span><span>
</span><a name="line-440"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#NoUnexpectedThunks"><span class="hs-identifier hs-type">NoUnexpectedThunks</span></a><span> </span><span class="hs-keyword">via</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src/Cardano.Prelude.GHC.Heap.NormalForm.Classy.html#OnlyCheckIsWHNF"><span class="hs-identifier hs-type">OnlyCheckIsWHNF</span></a><span> </span><span class="hs-string">&quot;CertKeyVRF&quot;</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#Proof"><span class="hs-identifier hs-type">Proof</span></a><span>
</span><a name="line-441"></a><span>
</span><a name="line-442"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Signable</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.Util.html#SignableRepresentation"><span class="hs-identifier hs-type">SignableRepresentation</span></a><span>
</span><a name="line-443"></a><span>
</span><a name="line-444"></a><span>  </span><a name="local-8214565720323791926"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#algorithmNameVRF"><span class="hs-identifier">algorithmNameVRF</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-string">&quot;PraosVRF&quot;</span><span>
</span><a name="line-445"></a><span>
</span><a name="line-446"></a><span>  </span><a name="local-8214565720323791925"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#deriveVerKeyVRF"><span class="hs-identifier">deriveVerKeyVRF</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">coerce</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#skToVerKey"><span class="hs-identifier hs-var">skToVerKey</span></a><span>
</span><a name="line-447"></a><span>
</span><a name="line-448"></a><span>  </span><a name="local-8214565720323791923"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#evalVRF"><span class="hs-identifier">evalVRF</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679042083"><a href="#local-6989586621679042083"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Crypto.VRF.Praos.html#SignKeyPraosVRF"><span class="hs-identifier hs-var">SignKeyPraosVRF</span></a><span> </span><a name="local-6989586621679042084"><a href="#local-6989586621679042084"><span class="hs-identifier">sk</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-449"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679042085"><a href="#local-6989586621679042085"><span class="hs-identifier">msgBS</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.Util.html#getSignableRepresentation"><span class="hs-identifier hs-var">getSignableRepresentation</span></a><span> </span><a href="#local-6989586621679042083"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-450"></a><span>        </span><a name="local-6989586621679042086"><a href="#local-6989586621679042086"><span class="hs-identifier">proof</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Invalid Key&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#prove"><span class="hs-identifier hs-var">prove</span></a><span> </span><a href="#local-6989586621679042084"><span class="hs-identifier hs-var">sk</span></a><span> </span><a href="#local-6989586621679042085"><span class="hs-identifier hs-var">msgBS</span></a><span>
</span><a name="line-451"></a><span>        </span><a name="local-6989586621679042087"><a href="#local-6989586621679042087"><span class="hs-identifier">output</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Invalid Proof&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#outputFromProof"><span class="hs-identifier hs-var">outputFromProof</span></a><span> </span><a href="#local-6989586621679042086"><span class="hs-identifier hs-var">proof</span></a><span>
</span><a name="line-452"></a><span>    </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679042087"><span class="hs-identifier hs-var">output</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679042086"><span class="hs-identifier hs-var">proof</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span>
</span><a name="line-453"></a><span>           </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#OutputVRF"><span class="hs-identifier hs-var">OutputVRF</span></a><span> </span><span class="hs-special">(</span><a href="Cardano.Crypto.VRF.Praos.html#outputBytes"><span class="hs-identifier hs-var">outputBytes</span></a><span> </span><a href="#local-6989586621679042087"><span class="hs-identifier hs-var">output</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#CertPraosVRF"><span class="hs-identifier hs-var">CertPraosVRF</span></a><span> </span><a href="#local-6989586621679042086"><span class="hs-identifier hs-var">proof</span></a><span class="hs-special">)</span><span>
</span><a name="line-454"></a><span>
</span><a name="line-455"></a><span>  </span><a name="local-8214565720323791922"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#verifyVRF"><span class="hs-identifier">verifyVRF</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Cardano.Crypto.VRF.Praos.html#VerKeyPraosVRF"><span class="hs-identifier hs-var">VerKeyPraosVRF</span></a><span> </span><a name="local-6989586621679042102"><a href="#local-6989586621679042102"><span class="hs-identifier">pk</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679042103"><a href="#local-6989586621679042103"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#CertPraosVRF"><span class="hs-identifier hs-var">CertPraosVRF</span></a><span> </span><a name="local-6989586621679042104"><a href="#local-6989586621679042104"><span class="hs-identifier">proof</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-456"></a><span>    </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#verify"><span class="hs-identifier hs-var">verify</span></a><span> </span><a href="#local-6989586621679042102"><span class="hs-identifier hs-var">pk</span></a><span> </span><a href="#local-6989586621679042104"><span class="hs-identifier hs-var">proof</span></a><span> </span><span class="hs-special">(</span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.Util.html#getSignableRepresentation"><span class="hs-identifier hs-var">getSignableRepresentation</span></a><span> </span><a href="#local-6989586621679042103"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-457"></a><span>
</span><a name="line-458"></a><span>  </span><a name="local-8214565720323791915"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#sizeOutputVRF"><span class="hs-identifier">sizeOutputVRF</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_outputbytes"><span class="hs-identifier hs-var">crypto_vrf_outputbytes</span></a><span>
</span><a name="line-459"></a><span>  </span><a name="local-8214565720323791919"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#seedSizeVRF"><span class="hs-identifier">seedSizeVRF</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_seedbytes"><span class="hs-identifier hs-var">crypto_vrf_seedbytes</span></a><span>
</span><a name="line-460"></a><span>
</span><a name="line-461"></a><span>  </span><a name="local-8214565720323791920"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#genKeyPairVRF"><span class="hs-identifier">genKeyPairVRF</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679042603"><a href="#local-6989586621679042603"><span class="hs-identifier">cryptoseed</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-462"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679042604"><a href="#local-6989586621679042604"><span class="hs-identifier">seed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#seedFromBytes"><span class="hs-identifier hs-var">seedFromBytes</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.Seed.html#getBytesFromSeedT"><span class="hs-identifier hs-var">getBytesFromSeedT</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#crypto_vrf_seedbytes"><span class="hs-identifier hs-var">crypto_vrf_seedbytes</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679042603"><span class="hs-identifier hs-var">cryptoseed</span></a><span>
</span><a name="line-463"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679042605"><a href="#local-6989586621679042605"><span class="hs-identifier">pk</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679042606"><a href="#local-6989586621679042606"><span class="hs-identifier">sk</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#keypairFromSeed"><span class="hs-identifier hs-var">keypairFromSeed</span></a><span> </span><a href="#local-6989586621679042604"><span class="hs-identifier hs-var">seed</span></a><span>
</span><a name="line-464"></a><span>    </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679042606"><span class="hs-identifier hs-var">sk</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679042605"><span class="hs-identifier hs-var">pk</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="Cardano.Crypto.VRF.Praos.html#SignKeyPraosVRF"><span class="hs-identifier hs-var">SignKeyPraosVRF</span></a><span> </span><a href="#local-6989586621679042606"><span class="hs-identifier hs-var">sk</span></a><span class="hs-special">,</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#VerKeyPraosVRF"><span class="hs-identifier hs-var">VerKeyPraosVRF</span></a><span> </span><a href="#local-6989586621679042605"><span class="hs-identifier hs-var">pk</span></a><span class="hs-special">)</span><span>
</span><a name="line-465"></a><span>
</span><a name="line-466"></a><span>  </span><a name="local-8214565720323791914"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#rawSerialiseVerKeyVRF"><span class="hs-identifier">rawSerialiseVerKeyVRF</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Crypto.VRF.Praos.html#VerKeyPraosVRF"><span class="hs-identifier hs-var">VerKeyPraosVRF</span></a><span> </span><a name="local-6989586621679042622"><a href="#local-6989586621679042622"><span class="hs-identifier">pk</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#vkBytes"><span class="hs-identifier hs-var">vkBytes</span></a><span> </span><a href="#local-6989586621679042622"><span class="hs-identifier hs-var">pk</span></a><span>
</span><a name="line-467"></a><span>  </span><a name="local-8214565720323791913"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#rawSerialiseSignKeyVRF"><span class="hs-identifier">rawSerialiseSignKeyVRF</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Crypto.VRF.Praos.html#SignKeyPraosVRF"><span class="hs-identifier hs-var">SignKeyPraosVRF</span></a><span> </span><a name="local-6989586621679042623"><a href="#local-6989586621679042623"><span class="hs-identifier">sk</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#skBytes"><span class="hs-identifier hs-var">skBytes</span></a><span> </span><a href="#local-6989586621679042623"><span class="hs-identifier hs-var">sk</span></a><span>
</span><a name="line-468"></a><span>  </span><a name="local-8214565720323791912"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#rawSerialiseCertVRF"><span class="hs-identifier">rawSerialiseCertVRF</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Crypto.VRF.Praos.html#CertPraosVRF"><span class="hs-identifier hs-var">CertPraosVRF</span></a><span> </span><a name="local-6989586621679042624"><a href="#local-6989586621679042624"><span class="hs-identifier">proof</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#proofBytes"><span class="hs-identifier hs-var">proofBytes</span></a><span> </span><a href="#local-6989586621679042624"><span class="hs-identifier hs-var">proof</span></a><span>
</span><a name="line-469"></a><span>  </span><a name="local-8214565720323791911"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#rawDeserialiseVerKeyVRF"><span class="hs-identifier">rawDeserialiseVerKeyVRF</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Cardano.Crypto.VRF.Praos.html#VerKeyPraosVRF"><span class="hs-identifier hs-var">VerKeyPraosVRF</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#vkFromBytes"><span class="hs-identifier hs-var">vkFromBytes</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#assertLength"><span class="hs-identifier hs-var">assertLength</span></a><span> </span><a href="Cardano.Crypto.VRF.Praos.html#verKeySizeVRF"><span class="hs-identifier hs-var">verKeySizeVRF</span></a><span>
</span><a name="line-470"></a><span>  </span><a name="local-8214565720323791910"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#rawDeserialiseSignKeyVRF"><span class="hs-identifier">rawDeserialiseSignKeyVRF</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Cardano.Crypto.VRF.Praos.html#SignKeyPraosVRF"><span class="hs-identifier hs-var">SignKeyPraosVRF</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#skFromBytes"><span class="hs-identifier hs-var">skFromBytes</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#assertLength"><span class="hs-identifier hs-var">assertLength</span></a><span> </span><a href="Cardano.Crypto.VRF.Praos.html#signKeySizeVRF"><span class="hs-identifier hs-var">signKeySizeVRF</span></a><span>
</span><a name="line-471"></a><span>  </span><a name="local-8214565720323791909"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#rawDeserialiseCertVRF"><span class="hs-identifier">rawDeserialiseCertVRF</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Cardano.Crypto.VRF.Praos.html#CertPraosVRF"><span class="hs-identifier hs-var">CertPraosVRF</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#proofFromBytes"><span class="hs-identifier hs-var">proofFromBytes</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#assertLength"><span class="hs-identifier hs-var">assertLength</span></a><span> </span><a href="Cardano.Crypto.VRF.Praos.html#certSizeVRF"><span class="hs-identifier hs-var">certSizeVRF</span></a><span>
</span><a name="line-472"></a><span>
</span><a name="line-473"></a><span>  </span><a name="local-8214565720323791918"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#sizeVerKeyVRF"><span class="hs-identifier">sizeVerKeyVRF</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#verKeySizeVRF"><span class="hs-identifier hs-var">verKeySizeVRF</span></a><span>
</span><a name="line-474"></a><span>  </span><a name="local-8214565720323791917"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#sizeSignKeyVRF"><span class="hs-identifier">sizeSignKeyVRF</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#signKeySizeVRF"><span class="hs-identifier hs-var">signKeySizeVRF</span></a><span>
</span><a name="line-475"></a><span>  </span><a name="local-8214565720323791916"><a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src/Cardano.Crypto.VRF.Class.html#sizeCertVRF"><span class="hs-identifier">sizeCertVRF</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="Cardano.Crypto.VRF.Praos.html#certSizeVRF"><span class="hs-identifier hs-var">certSizeVRF</span></a><span>
</span><a name="line-476"></a><span>
</span><a name="line-477"></a><span class="hs-identifier">assertLength</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-478"></a><a name="assertLength"><a href="Cardano.Crypto.VRF.Praos.html#assertLength"><span class="hs-identifier">assertLength</span></a></a><span> </span><a name="local-6989586621679044933"><a href="#local-6989586621679044933"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679044934"><a href="#local-6989586621679044934"><span class="hs-identifier">bs</span></a></a><span>
</span><a name="line-479"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">BS.length</span><span> </span><a href="#local-6989586621679044934"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679044933"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-480"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679044934"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-481"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-482"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-483"></a></pre></body></html>